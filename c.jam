#  ```jam
#  # launch example: bjam -s jln_sanitizers=on
#
#  include cpp.jam ;
#
#  # rule jln_flags ( properties * )
#
#  project name : requirements
#    <jln-lto-default>on # enable jln-lto
#    <jln-hardened-default>on
#    <conditional>@jln_flags
#  : default-build release ;
#
#  exe test : test.cpp : <jln-hardened-incidental>off # incidental version of <jln-hardened>off
#
#  # NOTE: for C, jln_flags becomes jln_c_flags
#  ```
#
#
#  # Options
#
#  Supported options are listed below by category.
#  The same option can be found in several categories.
#
#  For a full description of options and values,
#  see [C++ Compiler Options reference](https://jonathanpoelen.github.io/cpp-compiler-options/)
#  or use the `list_options.lua` generator.
#
#  The first value corresponds to the one used by default,
#  and the value `default` has no associated behavior.
#
#  Options with a default value other than `default` are listed below.
#
#  <!-- ./compiler-options.lua generators/list_options.lua --color --categorized -->
#  ```ini
#  # Warning options:
#
#  warnings = on default off essential extensive
#  warnings_as_error = default off on basic
#  conversion_warnings = on default off sign float conversion all
#  covered_switch_default_warnings = on default off
#  msvc_crt_secure_no_warnings = on default off
#  noexcept_warnings = default off on
#  reproducible_build_warnings = default off on
#  shadow_warnings = off default on local compatible_local all
#  suggest_attributes = on default off common analysis unity all
#  switch_warnings = on default off exhaustive_enum mandatory_default exhaustive_enum_and_mandatory_default
#  unsafe_buffer_usage_warnings = default on off
#  windows_abi_compatibility_warnings = off default on
#
#
#  # Pedantic options:
#
#  pedantic = on default off as_error
#  stl_fix = on default off
#
#
#  # Debug options:
#
#  symbols = default hidden strip_all gc_sections nodebug debug minimal_debug full_debug btf codeview ctf ctf1 ctf2 vms vms1 vms2 vms3 dbx lldb sce dwarf
#  stl_hardening = default off fast extensive debug debug_with_broken_abi
#  sanitizers = default off on with_minimal_code_size extra extra_with_minimal_code_size address address_with_minimal_code_size thread undefined undefined_minimal_runtime scudo_hardened_allocator
#  var_init = default uninitialized pattern zero
#  emcc_debug = default off on slow
#  ndebug = with_optimization_1_or_above default off on
#  optimization = default 0 g 1 2 3 fast size z
#
#
#  # Optimization options:
#
#  cpu = default generic native
#  lto = default off on full thin_or_nothing whole_program whole_program_and_full_lto
#  optimization = default 0 g 1 2 3 fast size z
#  optimization_warnings = default off on
#
#
#  # C++ options:
#
#  exceptions = default off on
#  rtti = default off on
#
#
#  # Hardening options:
#
#  hardened = default off on all
#  stl_hardening = default off fast extensive debug debug_with_broken_abi
#
#
#  # Static Analyzer options:
#
#  analyzer = default off on with_external_headers
#  analyzer_too_complex_warning = default off on
#  analyzer_verbosity = default 0 1 2 3
#
#
#  # Other options:
#
#  color = default auto never always
#  coverage = default off on
#  diagnostics_format = default fixits patch print_source_range_info
#  diagnostics_show_template = default tree without_elided_types tree_without_elided_types
#  linker = default bfd gold lld mold native
#  msvc_diagnostics_format = caret default classic column
#  msvc_isystem = default anglebrackets include_and_caexcludepath external_as_include_system_flag assumed
#  msvc_isystem_with_template_instantiations_treated_as_non_external = default off on
#  windows_bigobj = on default
#  ```
#  <!-- ./compiler-options.lua -->
#
#  If not specified:
#
#  - `msvc_diagnostics_format` is `caret`
#  - `ndebug` is `with_optimization_1_or_above`
#  - The following values are `off`:
#    - `shadow_warnings`
#    - `windows_abi_compatibility_warnings`
#  - The following values are `on`:
#    - `conversion_warnings`
#    - `covered_switch_default_warnings`
#    - `msvc_crt_secure_no_warnings`
#    - `pedantic`
#    - `stl_fix`
#    - `suggest_attributes`
#    - `switch_warnings`
#    - `warnings`
#    - `windows_bigobj`
#
#  <!-- enddefault -->
#
#  ## To know
#
#  - `msvc_isystem=external_as_include_system_flag` is only available with `cmake`.
#  - `stl_hardening=debug`
#    - msvc: unlike `stl_hardening=debug_with_broken_abi`, STL debugging is not enabled by this option, as it breaks the ABI (only hardening mode is enabled on recent versions). However, as the `_DEBUG` macro can be defined in many different ways, STL debugging can be activated and the ABI broken.
#
#
#  ## Sanitizers
#
#  Some sanitizers activated at compile time are only realistically active in the presence of a configuration in an environment variable.
#  `sanitizers=on` does not include these sanitizers, unlike `sanitizers=extra`.
#  The environment variables to use are as follows:
#
#  ```sh
#  # cl (Windows)
#  ASAN_OPTIONS=detect_stack_use_after_return=1
#
#  # gcc / clang (see -fsanitize=pointer-subtract and -fsanitize=pointer-compare)
#  ASAN_OPTIONS=detect_invalid_pointer_pairs=2
#
#  # macOS
#  ASAN_OPTIONS=detect_leaks=1
#  ```
#
#  See
#  [AddressSanitizer](https://github.com/google/sanitizers/wiki/AddressSanitizer),
#  [UndefinedBehaviorSanitizer](https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html),
#  [-fsanitize=pointer-compare](https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html#index-fsanitize_003dpointer-compare) with GCC and
#  [-fsanitize-address-use-after-return](https://learn.microsoft.com/en-us/cpp/sanitizers/asan-building#fsanitize-address-use-after-return-compiler-option-experimental) with cl compiler
#  for more details.
#
#  See [AddressSanitizer Flags](https://github.com/google/sanitizers/wiki/AddressSanitizerFlags#run-time-flags)
#  for a list of supported options.
#  A useful pre-set to enable more aggressive diagnostics compared to the default behavior is given below:
#
#  ```sh
#  ASAN_OPTIONS=\
#  strict_string_checks=1:\
#  detect_stack_use_after_return=1:\
#  check_initialization_order=1:\
#  strict_init_order=1:\
#  alloc_dealloc_mismatch=1
#  ```
#
#  ## Recommended options
#
#  category | options
#  ---------|---------
#  debug | `emcc_debug=on` or `slow` (useless if Emscripten is not used)<br>`optimization=g` or `default`<br>`sanitizers=on` or `with_minimal_code_size`<br>`stl_hardening=debug_with_broken_abi` or `debug`<br>`symbols=debug` or `full_debug`<br>`var_init=pattern`
#  release | `cpu=native`<br>`lto=on`<br>`optimization=3`<br>`rtti=off`<br>`symbols=strip_all`
#  security | `hardened=on`<br>`stl_hardening=fast` or `extensive`
#  really strict warnings | `pedantic=as_error`<br>`suggest_attributes=common`<br>`warnings=extensive`<br>`conversion_warnings=all`<br>`shadow_warnings=local`<br>`switch_warnings=exhaustive_enum`<br>`windows_abi_compatibility_warnings=on`
#
#  

# File generated with https://github.com/jonathanpoelen/cpp-compiler-options

# jam reference: https://www.boost.org/build/doc/html/index.html

import feature : feature ;
import modules ;
import numbers ;
import os ;
import property-set ;
import string ;

JLN_BJAM_YEAR_VERSION = [ modules.peek : JAMVERSION ] ;

# Enables an static analysis. It can have false positives and false negatives. It is a bug-finding tool, rather than a tool for proving program correctness. Available only with GCC and MSVC.
feature <jln-analyzer> : _ default off on with-external-headers : propagated ;
# By default, the analysis silently stops if the code is too complicated for the analyzer to fully explore and it reaches an internal limit. This option warns if this occurs. Available only with GCC.
feature <jln-analyzer-too-complex-warning> : _ default off on : propagated ;
# Controls the complexity of the control flow paths that are emitted for analyzer diagnostics. Available only with GCC.
#  - 0: At this level, interprocedural call and return events are displayed, along with the most pertinent state-change events relating to a diagnostic. For example, for a double-free diagnostic, both calls to free will be shown.
#  - 1: As per the previous level, but also show events for the entry to each function.
#  - 2: As per the previous level, but also show events relating to control flow that are significant to triggering the issue (e.g. "true path taken" at a conditional). This level is the default.
#  - 3: As per the previous level, but show all control flow events, not just significant ones.
feature <jln-analyzer-verbosity> : _ default 0 1 2 3 : propagated ;
feature <jln-color> : _ default auto never always : propagated ;
# Warn for implicit conversions that may alter a value.
#  - on: Combine conversion and sign value
#  - sign: Warn for implicit conversions that may change the sign (the `unsigned_integer = signed_integer`) or a comparison between signed and unsigned values could produce an incorrect result when the signed value is converted to unsigned.
#  - float: Warn for implicit conversions that reduce the precision of a real value.
#  - conversion: Warn for implicit conversions that may alter a value.
#  - all: Like conversion and also warn about implicit conversions from arithmetic operations even when conversion of the operands to the same type cannot change their values.
feature <jln-conversion-warnings> : _ on default off sign float conversion all : propagated ;
feature <jln-coverage> : _ default off on : incidental ;
# Warning for default label in switch which covers all enumeration values.
feature <jln-covered-switch-default-warnings> : _ on default off : propagated ;
feature <jln-cpu> : _ default generic native : incidental ;
# Emit fix-it hints in a machine-parseable format.
feature <jln-diagnostics-format> : _ default fixits patch print-source-range-info : propagated ;
# Add checks with Emscripten compiler.
#  - off: Disable checks used with default `-O0` optimization.
#  - on: Activate some checks in addition to those used with default `-O0` optimization.
#  - slow: Activate checks that can greatly slow down the program.
feature <jln-emcc-debug> : _ default off on slow : incidental ;
# Enable C++ exceptions.
feature <jln-exceptions> : _ default off on : incidental ;
# Enable a set of flags for C and C++ that improve the security of the generated code without affecting its ABI. Can impact performance.
#  - off: Use `/GS-` with MSVC-like compiler. Does nothing with other compilers.
#  - all: Use -fstack-protector-all instead of -fstack-protector-strong
feature <jln-hardened> : _ default off on all : incidental ;
# Configure linker.
feature <jln-linker> : _ default bfd gold lld mold native : propagated ;
# Enable Link Time Optimization. Also known as interprocedural optimization (IPO).
#  - on: Activates ThinLTO when available (Clang), otherwise FullLTO.
#  - full: Activates FullLTO.
#  - thin_or_nothing: Activates ThinLTO. Disable lto when not supported.
#  - whole_program: Assume that the current compilation unit represents the whole program being compiled. This option should not be used to compile a library. When not supported by the compiler, ThinLTO or FullLTO are used.
#  - whole_program_and_full_lto: Same as `whole_program`, but use FullLTO when not supported.
feature <jln-lto> : _ default off on full thin-or-nothing whole-program whole-program-and-full-lto : incidental ;
# Disable CRT warnings with MSVC.
feature <jln-msvc-crt-secure-no-warnings> : _ on default off : propagated ;
# Controls the display of error and warning information (https://learn.microsoft.com/en-us/cpp/build/reference/diagnostics-compiler-diagnostic-options).
#  - classic: Which reports only the line number where the issue was found.
#  - column: Includes the column where the issue was found. This can help you identify the specific language construct or character that is causing the issue.
#  - caret: Includes the column where the issue was found and places a caret (^) under the location in the line of code where the issue was detected.
feature <jln-msvc-diagnostics-format> : _ caret default classic column : propagated ;
# Warnings concerning external header (https://devblogs.microsoft.com/cppblog/broken-warnings-theory).
feature <jln-msvc-isystem> : _ default anglebrackets include-and-caexcludepath assumed : propagated ;
# Enable `NDEBUG` macro (disable assert macro).
feature <jln-ndebug> : _ with-optimization-1-or-above default off on : incidental ;
# Optimization level.
#  - 0: Not optimize.
#  - g: Enable debugging experience.
#  - 1: Optimize.
#  - 2: Optimize even more.
#  - 3: Optimize yet more.
#  - fast: Enables all `optimization=3` and disregard strict standards compliance.
#  - size: Optimize for size.
#  - z: Optimize for size aggressively (/!\ possible slow compilation with emcc).
feature <jln-optimization> : _ default 0 g 1 2 3 fast size z : incidental ;
# Issue all the warnings demanded by strict ISO C and ISO C++.
feature <jln-pedantic> : _ on default off as-error : incidental ;
# Warn when macros "__TIME__", "__DATE__" or "__TIMESTAMP__" are encountered as they might prevent bit-wise-identical reproducible compilations.
feature <jln-reproducible-build-warnings> : _ default off on : propagated ;
# Enable sanitizers (asan, ubsan, etc) when available.
#  - on: Enable address sanitizer and other compatible sanitizers
#  - with_minimal_code_size: Enable address sanitizer and other compatible sanitizers, but reduces code size by removing the possibility of deleting checks via an environment variable when possible (use `-fsanitize-address-use-after-return=runtime` with Clang family).
#  - extra: Enable address sanitizer and other compatible sanitizers, even those who require a config via environment variable.
#  - extra_with_minimal_code_size: Combines `extra` and `with_minimal_code_size` values.
#  - address: Enable address sanitizer only.
#  - address_with_minimal_code_size: Enable address sanitizer only, but reduces code size by removing the possibility of deleting checks via an environment variable when possible (use `-fsanitize-address-use-after-return=runtime` with Clang family).
#  - thread: Enable thread sanitizer.
#  - undefined: Enable undefined sanitizer.
#  - undefined_minimal_runtime: Enable undefined sanitizer with minimal UBSan runtime when available (Clang>=6).
#  - scudo_hardened_allocator: Enable Scudo Hardened Allocator with Clang. See https://llvm.org/docs/ScudoHardenedAllocator.html.
feature <jln-sanitizers> : _ default off on with-minimal-code-size extra extra-with-minimal-code-size address address-with-minimal-code-size thread undefined undefined-minimal-runtime scudo-hardened-allocator : incidental ;
feature <jln-shadow-warnings> : _ off default on local compatible-local all : propagated ;
# Enable `/DNOMINMAX` with MSVC.
feature <jln-stl-fix> : _ on default off : incidental ;
# Warn for cases where adding an attribute may be beneficial. With GCC, this  analysis requires option `-fipa-pure-const`, which is enabled by default at `-O1` and higher.
#  - on: Suggests noreturn attribute with Clang and GCC.
#  - common: Suggests noreturn and format attributes with GCC ; noreturn with Clang.
#  - analysis: Suggests noreturn, format attributes, malloc and returns_nonnull attributes with GCC ; noreturn with Clang.
#  - unity: Suggests noreturn, format attributes and final on types and methods ; noreturn with Clang.
#  - all: Active all suggestions for attributes.
feature <jln-suggest-attributes> : _ on default off common analysis unity all : propagated ;
# Warnings concerning the switch keyword.
feature <jln-switch-warnings> : _ on default off exhaustive-enum mandatory-default exhaustive-enum-and-mandatory-default : propagated ;
# Produce debugging information in the operating system's.
#  - hidden: Use `-fvisibility=hidden` with Clang, GCC and other compilers that support this flag.
#  - strip_all: Strip all symbols.
#  - gc_sections: Enable garbage collection of unused sections.
#  - nodebug: Request no debugging information.
#  - debug: Request debugging information. How much information can be controlled with options `minimal_debug` and `full_debug`.
#  - minimal_debug: If possible, produces information for tracebacks only. This includes descriptions of functions and external variables, and line number tables, but no information about local variables. If the level is not supported by a compiler, this is equivalent to the `debug` option.
#  - full_debug: If possible, includes extra information, such as all the macro definitions present in the program.
#  - btf: GCC only. Request BTF debug information. BTF is the default debugging format for the eBPF  target.
#  - codeview: GCC only. Code View debug format (used by Microsoft Visual C++ on Windows).
#  - ctf: GCC only. Produce a CTF debug information. The default level is 2.
#  - ctf1: Level 1 produces CTF information for tracebacks only. This includes callsite information, but does not include type information.
#  - ctf2: Level 2 produces type information for entities (functions, data objects etc.)  at file-scope or global-scope only.
#  - vms: GCC only. Alpha/VMS debug format (used by DEBUG on Alpha/VMS systems).The default level is 2.
#  - vms1: Same as `minimal_debug`, but for Alpha/VMS.
#  - vms2: Same as `debug`, but for Alpha/VMS.
#  - vms3: Same as `full_debug`, but for Alpha/VMS.
#  - dbx: Clang only.
#  - lldb: Clang only.
#  - sce: Clang only.
#  - dwarf: Clang-cl only
feature <jln-symbols> : _ default hidden strip-all gc-sections nodebug debug minimal-debug full-debug btf codeview ctf ctf1 ctf2 vms vms1 vms2 vms3 dbx lldb sce dwarf : incidental ;
# Enable `-Wunsafe-buffer-usage` with Clang (https://clang.llvm.org/docs/SafeBuffers.html).
feature <jln-unsafe-buffer-usage-warnings> : _ default on off : propagated ;
# Initialize all stack variables implicitly, including padding.
#  - uninitialized: Doesn't initialize any automatic variables (default behavior of Clang and GCC).
#  - pattern: Initialize automatic variables with byte-repeatable pattern (0xFE for GCC, 0xAA for Clang).
#  - zero: zero Initialize automatic variables with zeroes.
feature <jln-var-init> : _ default uninitialized pattern zero : incidental ;
# Warning level.
#  - on: Activates essential warnings and extras.
#  - essential: Activates essential warnings, typically `-Wall -Wextra` or `/W4`).
#  - extensive: Activates essential warnings, extras and some that may raise false positives
feature <jln-warnings> : _ on default off essential extensive : propagated ;
# Make all or some warnings into errors.
feature <jln-warnings-as-error> : _ default off on basic : incidental ;
# Increases that addressable sections capacity.
feature <jln-windows-bigobj> : _ on default : incidental ;

feature <jln-coverage-incidental> : _ default off on : incidental ;
feature <jln-cpu-incidental> : _ default generic native : incidental ;
feature <jln-emcc-debug-incidental> : _ default off on slow : incidental ;
feature <jln-exceptions-incidental> : _ default off on : incidental ;
feature <jln-hardened-incidental> : _ default off on all : incidental ;
feature <jln-lto-incidental> : _ default off on full thin-or-nothing whole-program whole-program-and-full-lto : incidental ;
feature <jln-ndebug-incidental> : _ with-optimization-1-or-above default off on : incidental ;
feature <jln-optimization-incidental> : _ default 0 g 1 2 3 fast size z : incidental ;
feature <jln-pedantic-incidental> : _ on default off as-error : incidental ;
feature <jln-sanitizers-incidental> : _ default off on with-minimal-code-size extra extra-with-minimal-code-size address address-with-minimal-code-size thread undefined undefined-minimal-runtime scudo-hardened-allocator : incidental ;
feature <jln-stl-fix-incidental> : _ on default off : incidental ;
feature <jln-symbols-incidental> : _ default hidden strip-all gc-sections nodebug debug minimal-debug full-debug btf codeview ctf ctf1 ctf2 vms vms1 vms2 vms3 dbx lldb sce dwarf : incidental ;
feature <jln-var-init-incidental> : _ default uninitialized pattern zero : incidental ;
feature <jln-warnings-as-error-incidental> : _ default off on basic : incidental ;
feature <jln-windows-bigobj-incidental> : _ on default : incidental ;

feature <jln-analyzer-default> : default off on with-external-headers : incidental ;
feature <jln-analyzer-too-complex-warning-default> : default off on : incidental ;
feature <jln-analyzer-verbosity-default> : default 0 1 2 3 : incidental ;
feature <jln-color-default> : default auto never always : incidental ;
feature <jln-conversion-warnings-default> : on default off sign float conversion all : incidental ;
feature <jln-coverage-default> : default off on : incidental ;
feature <jln-covered-switch-default-warnings-default> : on default off : incidental ;
feature <jln-cpu-default> : default generic native : incidental ;
feature <jln-diagnostics-format-default> : default fixits patch print-source-range-info : incidental ;
feature <jln-emcc-debug-default> : default off on slow : incidental ;
feature <jln-exceptions-default> : default off on : incidental ;
feature <jln-hardened-default> : default off on all : incidental ;
feature <jln-linker-default> : default bfd gold lld mold native : incidental ;
feature <jln-lto-default> : default off on full thin-or-nothing whole-program whole-program-and-full-lto : incidental ;
feature <jln-msvc-crt-secure-no-warnings-default> : on default off : incidental ;
feature <jln-msvc-diagnostics-format-default> : caret default classic column : incidental ;
feature <jln-msvc-isystem-default> : default anglebrackets include-and-caexcludepath assumed : incidental ;
feature <jln-ndebug-default> : with-optimization-1-or-above default off on : incidental ;
feature <jln-optimization-default> : default 0 g 1 2 3 fast size z : incidental ;
feature <jln-pedantic-default> : on default off as-error : incidental ;
feature <jln-reproducible-build-warnings-default> : default off on : incidental ;
feature <jln-sanitizers-default> : default off on with-minimal-code-size extra extra-with-minimal-code-size address address-with-minimal-code-size thread undefined undefined-minimal-runtime scudo-hardened-allocator : incidental ;
feature <jln-shadow-warnings-default> : off default on local compatible-local all : incidental ;
feature <jln-stl-fix-default> : on default off : incidental ;
feature <jln-suggest-attributes-default> : on default off common analysis unity all : incidental ;
feature <jln-switch-warnings-default> : on default off exhaustive-enum mandatory-default exhaustive-enum-and-mandatory-default : incidental ;
feature <jln-symbols-default> : default hidden strip-all gc-sections nodebug debug minimal-debug full-debug btf codeview ctf ctf1 ctf2 vms vms1 vms2 vms3 dbx lldb sce dwarf : incidental ;
feature <jln-unsafe-buffer-usage-warnings-default> : default on off : incidental ;
feature <jln-var-init-default> : default uninitialized pattern zero : incidental ;
feature <jln-warnings-default> : on default off essential extensive : incidental ;
feature <jln-warnings-as-error-default> : default off on basic : incidental ;
feature <jln-windows-bigobj-default> : on default : incidental ;


rule jln_c-get-env ( env : values * )
{
  local x = [ os.environ $(env) ] ;
  if $(x)
  {
    if $(x) in $(values)
    {
      return $(x) ;
    }
    else
    {
      EXIT "Unknown '$(x)' for $(env)" : 7 ;
    }
  }
  else
  {
    return "" ;
  }
}

constant jln_c_env_analyzer : [ jln_c-get-env jln_analyzer : default off on with-external-headers ] ;
constant jln_c_env_analyzer_too_complex_warning : [ jln_c-get-env jln_analyzer_too_complex_warning : default off on ] ;
constant jln_c_env_analyzer_verbosity : [ jln_c-get-env jln_analyzer_verbosity : default 0 1 2 3 ] ;
constant jln_c_env_color : [ jln_c-get-env jln_color : default auto never always ] ;
constant jln_c_env_conversion_warnings : [ jln_c-get-env jln_conversion_warnings : on default off sign float conversion all ] ;
constant jln_c_env_coverage : [ jln_c-get-env jln_coverage : default off on ] ;
constant jln_c_env_covered_switch_default_warnings : [ jln_c-get-env jln_covered_switch_default_warnings : on default off ] ;
constant jln_c_env_cpu : [ jln_c-get-env jln_cpu : default generic native ] ;
constant jln_c_env_diagnostics_format : [ jln_c-get-env jln_diagnostics_format : default fixits patch print-source-range-info ] ;
constant jln_c_env_emcc_debug : [ jln_c-get-env jln_emcc_debug : default off on slow ] ;
constant jln_c_env_exceptions : [ jln_c-get-env jln_exceptions : default off on ] ;
constant jln_c_env_hardened : [ jln_c-get-env jln_hardened : default off on all ] ;
constant jln_c_env_linker : [ jln_c-get-env jln_linker : default bfd gold lld mold native ] ;
constant jln_c_env_lto : [ jln_c-get-env jln_lto : default off on full thin-or-nothing whole-program whole-program-and-full-lto ] ;
constant jln_c_env_msvc_crt_secure_no_warnings : [ jln_c-get-env jln_msvc_crt_secure_no_warnings : on default off ] ;
constant jln_c_env_msvc_diagnostics_format : [ jln_c-get-env jln_msvc_diagnostics_format : caret default classic column ] ;
constant jln_c_env_msvc_isystem : [ jln_c-get-env jln_msvc_isystem : default anglebrackets include-and-caexcludepath assumed ] ;
constant jln_c_env_ndebug : [ jln_c-get-env jln_ndebug : with-optimization-1-or-above default off on ] ;
constant jln_c_env_optimization : [ jln_c-get-env jln_optimization : default 0 g 1 2 3 fast size z ] ;
constant jln_c_env_pedantic : [ jln_c-get-env jln_pedantic : on default off as-error ] ;
constant jln_c_env_reproducible_build_warnings : [ jln_c-get-env jln_reproducible_build_warnings : default off on ] ;
constant jln_c_env_sanitizers : [ jln_c-get-env jln_sanitizers : default off on with-minimal-code-size extra extra-with-minimal-code-size address address-with-minimal-code-size thread undefined undefined-minimal-runtime scudo-hardened-allocator ] ;
constant jln_c_env_shadow_warnings : [ jln_c-get-env jln_shadow_warnings : off default on local compatible-local all ] ;
constant jln_c_env_stl_fix : [ jln_c-get-env jln_stl_fix : on default off ] ;
constant jln_c_env_suggest_attributes : [ jln_c-get-env jln_suggest_attributes : on default off common analysis unity all ] ;
constant jln_c_env_switch_warnings : [ jln_c-get-env jln_switch_warnings : on default off exhaustive-enum mandatory-default exhaustive-enum-and-mandatory-default ] ;
constant jln_c_env_symbols : [ jln_c-get-env jln_symbols : default hidden strip-all gc-sections nodebug debug minimal-debug full-debug btf codeview ctf ctf1 ctf2 vms vms1 vms2 vms3 dbx lldb sce dwarf ] ;
constant jln_c_env_unsafe_buffer_usage_warnings : [ jln_c-get-env jln_unsafe_buffer_usage_warnings : default on off ] ;
constant jln_c_env_var_init : [ jln_c-get-env jln_var_init : default uninitialized pattern zero ] ;
constant jln_c_env_warnings : [ jln_c-get-env jln_warnings : on default off essential extensive ] ;
constant jln_c_env_warnings_as_error : [ jln_c-get-env jln_warnings_as_error : default off on basic ] ;
constant jln_c_env_windows_bigobj : [ jln_c-get-env jln_windows_bigobj : on default ] ;

if $(JLN_BJAM_YEAR_VERSION) < 2016.00
{
  import toolset ;
  toolset.flags jln-coverage JLN_COVERAGE : <jln-coverage> ;
  toolset.flags jln-coverage-incidental JLN_COVERAGE_INCIDENTAL : <jln-coverage-incidental> ;
  toolset.flags jln-cpu JLN_CPU : <jln-cpu> ;
  toolset.flags jln-cpu-incidental JLN_CPU_INCIDENTAL : <jln-cpu-incidental> ;
  toolset.flags jln-emcc-debug JLN_EMCC_DEBUG : <jln-emcc-debug> ;
  toolset.flags jln-emcc-debug-incidental JLN_EMCC_DEBUG_INCIDENTAL : <jln-emcc-debug-incidental> ;
  toolset.flags jln-exceptions JLN_EXCEPTIONS : <jln-exceptions> ;
  toolset.flags jln-exceptions-incidental JLN_EXCEPTIONS_INCIDENTAL : <jln-exceptions-incidental> ;
  toolset.flags jln-hardened JLN_HARDENED : <jln-hardened> ;
  toolset.flags jln-hardened-incidental JLN_HARDENED_INCIDENTAL : <jln-hardened-incidental> ;
  toolset.flags jln-lto JLN_LTO : <jln-lto> ;
  toolset.flags jln-lto-incidental JLN_LTO_INCIDENTAL : <jln-lto-incidental> ;
  toolset.flags jln-ndebug JLN_NDEBUG : <jln-ndebug> ;
  toolset.flags jln-ndebug-incidental JLN_NDEBUG_INCIDENTAL : <jln-ndebug-incidental> ;
  toolset.flags jln-optimization JLN_OPTIMIZATION : <jln-optimization> ;
  toolset.flags jln-optimization-incidental JLN_OPTIMIZATION_INCIDENTAL : <jln-optimization-incidental> ;
  toolset.flags jln-pedantic JLN_PEDANTIC : <jln-pedantic> ;
  toolset.flags jln-pedantic-incidental JLN_PEDANTIC_INCIDENTAL : <jln-pedantic-incidental> ;
  toolset.flags jln-sanitizers JLN_SANITIZERS : <jln-sanitizers> ;
  toolset.flags jln-sanitizers-incidental JLN_SANITIZERS_INCIDENTAL : <jln-sanitizers-incidental> ;
  toolset.flags jln-stl-fix JLN_STL_FIX : <jln-stl-fix> ;
  toolset.flags jln-stl-fix-incidental JLN_STL_FIX_INCIDENTAL : <jln-stl-fix-incidental> ;
  toolset.flags jln-symbols JLN_SYMBOLS : <jln-symbols> ;
  toolset.flags jln-symbols-incidental JLN_SYMBOLS_INCIDENTAL : <jln-symbols-incidental> ;
  toolset.flags jln-var-init JLN_VAR_INIT : <jln-var-init> ;
  toolset.flags jln-var-init-incidental JLN_VAR_INIT_INCIDENTAL : <jln-var-init-incidental> ;
  toolset.flags jln-warnings-as-error JLN_WARNINGS_AS_ERROR : <jln-warnings-as-error> ;
  toolset.flags jln-warnings-as-error-incidental JLN_WARNINGS_AS_ERROR_INCIDENTAL : <jln-warnings-as-error-incidental> ;
  toolset.flags jln-windows-bigobj JLN_WINDOWS_BIGOBJ : <jln-windows-bigobj> ;
  toolset.flags jln-windows-bigobj-incidental JLN_WINDOWS_BIGOBJ_INCIDENTAL : <jln-windows-bigobj-incidental> ;

}

JLN_ORIGINAL_C_TOOLSET = "" ;
JLN_NORMALIZED_C_COMP = "" ;
JLN_NORMALIZED_C_COMP_VERSION = 100000 ;
JLN_NORMALIZED_C_IS_CLANG_LIKE = 0 ;

rule jln_c-update-normalized-compiler ( toolset : version )
{
  if $(JLN_ORIGINAL_C_TOOLSET) != $(toolset)
  {
    JLN_ORIGINAL_C_TOOLSET = $(toolset) ;

    local is_emcc = 0 ;
    local is_intel = 0 ;
    local is_clang = 0 ;
    switch $(toolset)  {
      case emscripten* : is_emcc = 1 ;
      case emcc* : is_emcc = 1 ;
      case intel : is_intel = 1 ;
      case icx* : is_intel = 1 ;
      case icpx* : is_intel = 1 ;
      case dpcpp* : is_intel = 1 ;
      case clang-cl : is_clang = 0 ;
      case clang* : is_clang = 1 ;
    }

    if $(is_emcc) = 1 {
      JLN_NORMALIZED_C_COMP = clang-emcc ;
      JLN_NORMALIZED_C_IS_CLANG_LIKE = 1 ;
      # get clang version. Assume emcc exists
      version = [ MATCH "clang version ([0-9]+\\.[0-9]+\\.[0-9]+)" : [ SHELL "emcc -v 2>&1" ] ] ;
    }
    # icx / icpx
    else if $(is_intel) = 1 {
      JLN_NORMALIZED_C_COMP = clang ;
      JLN_NORMALIZED_C_IS_CLANG_LIKE = 1 ;
      switch $(version)  {
        case 2021* : JLN_NORMALIZED_C_COMP_VERSION = 1200000 ;
        case 2022* : JLN_NORMALIZED_C_COMP_VERSION = 1400000 ;
        case 2023* : JLN_NORMALIZED_C_COMP_VERSION = 1600000 ;
        case 2024* : JLN_NORMALIZED_C_COMP_VERSION = 1800000 ;
        case 2025* : JLN_NORMALIZED_C_COMP_VERSION = 2000000 ;
        case 2026* : JLN_NORMALIZED_C_COMP_VERSION = 2200000 ;
        case 2027* : JLN_NORMALIZED_C_COMP_VERSION = 2400000 ;
        case 2028* : JLN_NORMALIZED_C_COMP_VERSION = 2600000 ;
        case 2029* : JLN_NORMALIZED_C_COMP_VERSION = 2800000 ;
        case 2030* : JLN_NORMALIZED_C_COMP_VERSION = 3000000 ;
      }
    }
    else {
      JLN_NORMALIZED_C_IS_CLANG_LIKE = $(is_clang) ;
      # TODO `version` is not the real version.
      # For toolset=gcc-5, version is 5 ; for clang-scan, version is ''
      JLN_NORMALIZED_C_COMP = $(toolset) ;
      version = [ MATCH "^[^0-9]*(.*)$" : $(version) ] ;
      if ! $(version) {
        version = [ MATCH "([0-9]+\\.[0-9]+\\.[0-9]+)" : [ SHELL "$(toolset) --version" ] ] ;
      }
    }

    if $(is_intel) = 0 {
      local match = [ MATCH "^([0-9]+)(\\.([0-9]+))?" : $(version) ] ;
      local major = $(match[1]) ;
      local minor = [ MATCH "(.....)$" : [ string.join 00000 $(match[3]) ] ] ;
      JLN_NORMALIZED_C_COMP_VERSION = $(major)$(minor) ;
    }
  }
}

rule jln_c-get-value ( ps : opt : env )
{
  local x = [ $(ps).get <$(opt)> ] ;
  if $(x) = "_"
  {
    x = $(env) ;
    if $(x) = ""
    {
      x = [ $(ps).get <$(opt)-default> ] ;
    }
  }
  return $(x) ;
}

rule jln_c-get-value2 ( ps : opt : iopt : env )
{
  local x = [ $(ps).get <$(opt)> ] ;
  if $(x) = "_"
  {
    x = [ $(ps).get <$(iopt)> ] ;
    if $(x) = "_"
    {
      x = $(env) ;
      if $(x) = ""
      {
        x = [ $(ps).get <$(opt)-default> ] ;
      }
    }
  }
  return $(x) ;
}

rule jln_c_flags ( properties * )
{
  local ps = [ property-set.create $(properties) ] ;
  local toolset = [ $(ps).get <toolset> ] ;
  local original_version = [ $(ps).get <toolset-$(toolset):version> ] ;
  jln_c-update-normalized-compiler $(toolset) : $(original_version) ;
  local linker = [ $(ps).get <linker> ] ;

  local flags = ;
  if $(JLN_BJAM_YEAR_VERSION) >= 2016.00
  {
    flags += 
      <relevant>jln-coverage
      <relevant>jln-cpu
      <relevant>jln-emcc-debug
      <relevant>jln-exceptions
      <relevant>jln-hardened
      <relevant>jln-lto
      <relevant>jln-ndebug
      <relevant>jln-optimization
      <relevant>jln-pedantic
      <relevant>jln-sanitizers
      <relevant>jln-stl-fix
      <relevant>jln-symbols
      <relevant>jln-var-init
      <relevant>jln-warnings-as-error
      <relevant>jln-windows-bigobj
    ;
  }

  local x_analyzer = [ jln_c-get-value $(ps) : jln-analyzer : $(jln_c_env_analyzer) ] ;
  local x_analyzer_too_complex_warning = [ jln_c-get-value $(ps) : jln-analyzer-too-complex-warning : $(jln_c_env_analyzer_too_complex_warning) ] ;
  local x_analyzer_verbosity = [ jln_c-get-value $(ps) : jln-analyzer-verbosity : $(jln_c_env_analyzer_verbosity) ] ;
  local x_color = [ jln_c-get-value $(ps) : jln-color : $(jln_c_env_color) ] ;
  local x_conversion_warnings = [ jln_c-get-value $(ps) : jln-conversion-warnings : $(jln_c_env_conversion_warnings) ] ;
  local x_coverage = [ jln_c-get-value2 $(ps) : jln-coverage : jln-coverage-incidental : $(jln_c_env_coverage) ] ;
  local x_covered_switch_default_warnings = [ jln_c-get-value $(ps) : jln-covered-switch-default-warnings : $(jln_c_env_covered_switch_default_warnings) ] ;
  local x_cpu = [ jln_c-get-value2 $(ps) : jln-cpu : jln-cpu-incidental : $(jln_c_env_cpu) ] ;
  local x_diagnostics_format = [ jln_c-get-value $(ps) : jln-diagnostics-format : $(jln_c_env_diagnostics_format) ] ;
  local x_emcc_debug = [ jln_c-get-value2 $(ps) : jln-emcc-debug : jln-emcc-debug-incidental : $(jln_c_env_emcc_debug) ] ;
  local x_exceptions = [ jln_c-get-value2 $(ps) : jln-exceptions : jln-exceptions-incidental : $(jln_c_env_exceptions) ] ;
  local x_hardened = [ jln_c-get-value2 $(ps) : jln-hardened : jln-hardened-incidental : $(jln_c_env_hardened) ] ;
  local x_linker = [ jln_c-get-value $(ps) : jln-linker : $(jln_c_env_linker) ] ;
  local x_lto = [ jln_c-get-value2 $(ps) : jln-lto : jln-lto-incidental : $(jln_c_env_lto) ] ;
  local x_msvc_crt_secure_no_warnings = [ jln_c-get-value $(ps) : jln-msvc-crt-secure-no-warnings : $(jln_c_env_msvc_crt_secure_no_warnings) ] ;
  local x_msvc_diagnostics_format = [ jln_c-get-value $(ps) : jln-msvc-diagnostics-format : $(jln_c_env_msvc_diagnostics_format) ] ;
  local x_msvc_isystem = [ jln_c-get-value $(ps) : jln-msvc-isystem : $(jln_c_env_msvc_isystem) ] ;
  local x_ndebug = [ jln_c-get-value2 $(ps) : jln-ndebug : jln-ndebug-incidental : $(jln_c_env_ndebug) ] ;
  local x_optimization = [ jln_c-get-value2 $(ps) : jln-optimization : jln-optimization-incidental : $(jln_c_env_optimization) ] ;
  local x_pedantic = [ jln_c-get-value2 $(ps) : jln-pedantic : jln-pedantic-incidental : $(jln_c_env_pedantic) ] ;
  local x_reproducible_build_warnings = [ jln_c-get-value $(ps) : jln-reproducible-build-warnings : $(jln_c_env_reproducible_build_warnings) ] ;
  local x_sanitizers = [ jln_c-get-value2 $(ps) : jln-sanitizers : jln-sanitizers-incidental : $(jln_c_env_sanitizers) ] ;
  local x_shadow_warnings = [ jln_c-get-value $(ps) : jln-shadow-warnings : $(jln_c_env_shadow_warnings) ] ;
  local x_stl_fix = [ jln_c-get-value2 $(ps) : jln-stl-fix : jln-stl-fix-incidental : $(jln_c_env_stl_fix) ] ;
  local x_suggest_attributes = [ jln_c-get-value $(ps) : jln-suggest-attributes : $(jln_c_env_suggest_attributes) ] ;
  local x_switch_warnings = [ jln_c-get-value $(ps) : jln-switch-warnings : $(jln_c_env_switch_warnings) ] ;
  local x_symbols = [ jln_c-get-value2 $(ps) : jln-symbols : jln-symbols-incidental : $(jln_c_env_symbols) ] ;
  local x_unsafe_buffer_usage_warnings = [ jln_c-get-value $(ps) : jln-unsafe-buffer-usage-warnings : $(jln_c_env_unsafe_buffer_usage_warnings) ] ;
  local x_var_init = [ jln_c-get-value2 $(ps) : jln-var-init : jln-var-init-incidental : $(jln_c_env_var_init) ] ;
  local x_warnings = [ jln_c-get-value $(ps) : jln-warnings : $(jln_c_env_warnings) ] ;
  local x_warnings_as_error = [ jln_c-get-value2 $(ps) : jln-warnings-as-error : jln-warnings-as-error-incidental : $(jln_c_env_warnings_as_error) ] ;
  local x_windows_bigobj = [ jln_c-get-value2 $(ps) : jln-windows-bigobj : jln-windows-bigobj-incidental : $(jln_c_env_windows_bigobj) ] ;

  if $(x_ndebug) != "default"
  {
    if ( $(JLN_NORMALIZED_C_COMP) = "msvc" || $(JLN_NORMALIZED_C_COMP) = "intel' && $(original_version) = 'windows" )
    {
      if $(x_ndebug) = "off"
      {
        flags +=
          <cflags>"/UNDEBUG"
        ;
      }
      else
      {
        if $(x_ndebug) = "on"
        {
          flags +=
            <cflags>"/DNDEBUG"
          ;
        }
        else
        {
          if $(x_optimization) != "default" && ! ( $(x_optimization) = "0" || $(x_optimization) = "g" )
          {
            flags +=
              <cflags>"/DNDEBUG"
            ;
          }
        }
      }
    }
    else
    {
      if $(x_ndebug) = "off"
      {
        flags +=
          <cflags>"-UNDEBUG"
        ;
      }
      else
      {
        if $(x_ndebug) = "on"
        {
          flags +=
            <cflags>"-DNDEBUG"
          ;
        }
        else
        {
          if $(x_optimization) != "default" && ! ( $(x_optimization) = "0" || $(x_optimization) = "g" )
          {
            flags +=
              <cflags>"-DNDEBUG"
            ;
          }
        }
      }
    }
  }
  if ( $(JLN_NORMALIZED_C_COMP) = "gcc" || $(JLN_NORMALIZED_C_IS_CLANG_LIKE) || $(JLN_NORMALIZED_C_COMP) = "clang-cl" )
  {
    if $(x_warnings) != "default"
    {
      if $(x_warnings) = "off"
      {
        flags +=
          <cflags>"-w"
        ;
      }
      else
      {
        if $(x_warnings) = "essential"
        {
          flags +=
            <cflags>"-Wall"
            <cflags>"-Wextra"
            <cflags>"-Wwrite-strings"
          ;
        }
        else
        {
          if $(JLN_NORMALIZED_C_COMP) = "gcc"
          {
            flags +=
              <cflags>"-Wall"
              <cflags>"-Wextra"
            ;
            if [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
            {
              flags +=
                <cflags>"-Wcast-align"
              ;
            }
            flags +=
              <cflags>"-Wcast-qual"
              <cflags>"-Wdisabled-optimization"
              <cflags>"-Wfloat-equal"
              <cflags>"-Wformat-security"
              <cflags>"-Wformat=2"
              <cflags>"-Winvalid-pch"
              <cflags>"-Wmissing-declarations"
              <cflags>"-Wmissing-include-dirs"
              <cflags>"-Wpacked"
              <cflags>"-Wredundant-decls"
              <cflags>"-Wundef"
              <cflags>"-Wunused-macros"
              <cflags>"-Wpointer-arith"
              <cflags>"-Wbad-function-cast"
              <cflags>"-Winit-self"
              <cflags>"-Wjump-misses-init"
              <cflags>"-Wnested-externs"
              <cflags>"-Wold-style-definition"
              <cflags>"-Wstrict-prototypes"
              <cflags>"-Wwrite-strings"
            ;
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400007 ]
            {
              flags +=
                <cflags>"-Wsuggest-attribute=noreturn"
                <cflags>"-Wlogical-op"
                <cflags>"-Wvector-operation-performance"
                <cflags>"-Wdouble-promotion"
                <cflags>"-Wtrampolines"
              ;
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400008 ]
              {
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400009 ]
                {
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500001 ]
                  {
                    flags +=
                      <cflags>"-Wformat-signedness"
                      <cflags>"-Warray-bounds=2"
                    ;
                    if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 600001 ]
                    {
                      flags +=
                        <cflags>"-Wduplicated-cond"
                        <cflags>"-Wnull-dereference"
                      ;
                      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700000 ]
                      {
                        if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700001 ]
                        {
                          flags +=
                            <cflags>"-Walloc-zero"
                            <cflags>"-Walloca"
                            <cflags>"-Wformat-overflow=2"
                            <cflags>"-Wduplicated-branches"
                          ;
                          if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
                          {
                            flags +=
                              <cflags>"-Wcast-align=strict"
                              <cflags>"-Wformat-truncation=2"
                              <cflags>"-Wshift-overflow=2"
                            ;
                            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1400000 ]
                            {
                              flags +=
                                <cflags>"-Walloc-size"
                              ;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            if $(x_warnings) = "extensive"
            {
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
              {
                flags +=
                  <cflags>"-Wstringop-overflow=4"
                ;
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1200000 ]
                {
                  flags +=
                    <cflags>"-Wuse-after-free=3"
                  ;
                }
              }
            }
          }
          else
          {
            flags +=
              <cflags>"-Weverything"
              <cflags>"-Wno-documentation"
              <cflags>"-Wno-documentation-unknown-command"
              <cflags>"-Wno-newline-eof"
              <cflags>"-Wno-padded"
              <cflags>"-Wno-global-constructors"
            ;
            if  ! ( ( $(x_switch_warnings) = "off" || $(x_switch_warnings) = "exhaustive-enum" || $(x_switch_warnings) = "exhaustive-enum-and-mandatory-default" ) )
            {
              flags +=
                <cflags>"-Wno-switch-enum"
              ;
            }
            if $(x_covered_switch_default_warnings) = "default"
            {
              flags +=
                <cflags>"-Wno-covered-switch-default"
              ;
            }
            if $(x_suggest_attributes) = "default"
            {
              flags +=
                <cflags>"-Wno-missing-noreturn"
              ;
            }
            if $(x_conversion_warnings) != "default"
            {
              if $(x_conversion_warnings) = "conversion"
              {
                flags +=
                  <cflags>"-Wno-sign-compare"
                  <cflags>"-Wno-sign-conversion"
                ;
              }
              else
              {
                if ( $(x_conversion_warnings) = "float" || $(x_conversion_warnings) = "sign" )
                {
                  flags +=
                    <cflags>"-Wno-conversion"
                  ;
                }
              }
            }
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 300009 ]
            {
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500000 ]
              {
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 900000 ]
                {
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1000000 ]
                  {
                    if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1100000 ]
                    {
                      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1600000 ]
                      {
                        if $(x_unsafe_buffer_usage_warnings) = "default"
                        {
                          flags +=
                            <cflags>"-Wno-unsafe-buffer-usage"
                          ;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    if $(JLN_NORMALIZED_C_COMP) = "gcc"
    {
      if $(x_switch_warnings) != "default"
      {
        if $(x_switch_warnings) = "on"
        {
          flags +=
            <cflags>"-Wswitch"
          ;
        }
        else
        {
          if $(x_switch_warnings) = "exhaustive-enum"
          {
            flags +=
              <cflags>"-Wswitch-enum"
            ;
          }
          else
          {
            if $(x_switch_warnings) = "mandatory-default"
            {
              flags +=
                <cflags>"-Wswitch-default"
              ;
            }
            else
            {
              if $(x_switch_warnings) = "exhaustive-enum-and-mandatory-default"
              {
                flags +=
                  <cflags>"-Wswitch-default"
                  <cflags>"-Wswitch-enum"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-Wno-switch"
                  <cflags>"-Wno-switch-enum"
                  <cflags>"-Wno-switch-default"
                ;
              }
            }
          }
        }
      }
    }
    else
    {
      if $(x_switch_warnings) != "default"
      {
        if $(x_switch_warnings) = "on"
        {
          flags +=
            <cflags>"-Wswitch"
            <cflags>"-Wno-switch-default"
          ;
        }
        else
        {
          if $(x_switch_warnings) = "mandatory-default"
          {
            flags +=
              <cflags>"-Wswitch"
              <cflags>"-Wswitch-default"
            ;
          }
          else
          {
            if $(x_switch_warnings) = "exhaustive-enum"
            {
              flags +=
                <cflags>"-Wswitch"
                <cflags>"-Wswitch-enum"
                <cflags>"-Wno-switch-default"
              ;
            }
            else
            {
              if $(x_switch_warnings) = "exhaustive-enum-and-mandatory-default"
              {
                flags +=
                  <cflags>"-Wswitch"
                  <cflags>"-Wswitch-enum"
                  <cflags>"-Wswitch-default"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-Wno-switch"
                  <cflags>"-Wno-switch-enum"
                  <cflags>"-Wno-switch-default"
                ;
              }
            }
          }
        }
      }
      if $(x_covered_switch_default_warnings) != "default"
      {
        if $(x_covered_switch_default_warnings) = "off"
        {
          flags +=
            <cflags>"-Wno-covered-switch-default"
          ;
        }
        else
        {
          flags +=
            <cflags>"-Wcovered-switch-default"
          ;
        }
      }
    }
    if $(x_unsafe_buffer_usage_warnings) != "default"
    {
      if ( ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1600000 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1600000 ] ) )
      {
        if $(x_unsafe_buffer_usage_warnings) = "off"
        {
          flags +=
            <cflags>"-Wno-unsafe-buffer-usage"
          ;
        }
      }
    }
    if $(x_shadow_warnings) != "default"
    {
      if $(x_shadow_warnings) = "off"
      {
        flags +=
          <cflags>"-Wno-shadow"
        ;
        if ( ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ] ) )
        {
          flags +=
            <cflags>"-Wno-shadow-field"
          ;
        }
      }
      else
      {
        if $(x_shadow_warnings) = "on"
        {
          flags +=
            <cflags>"-Wshadow"
          ;
        }
        else
        {
          if $(x_shadow_warnings) = "all"
          {
            if $(JLN_NORMALIZED_C_COMP) = "gcc"
            {
              flags +=
                <cflags>"-Wshadow"
              ;
            }
            else
            {
              flags +=
                <cflags>"-Wshadow-all"
              ;
            }
          }
          else
          {
            if ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700001 ] )
            {
              if $(x_shadow_warnings) = "local"
              {
                flags +=
                  <cflags>"-Wshadow=local"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-Wshadow=compatible-local"
                ;
              }
            }
          }
        }
      }
    }
    if $(x_suggest_attributes) != "default"
    {
      if $(x_suggest_attributes) = "on"
      {
        flags +=
          <cflags>"-Wmissing-noreturn"
        ;
      }
      else
      {
        if $(x_suggest_attributes) = "common"
        {
          flags +=
            <cflags>"-Wmissing-noreturn"
            <cflags>"-Wmissing-format-attribute"
          ;
        }
        else
        {
          if ( $(x_suggest_attributes) = "analysis" || $(x_suggest_attributes) = "all" )
          {
            flags +=
              <cflags>"-Wmissing-noreturn"
              <cflags>"-Wmissing-format-attribute"
            ;
            if $(JLN_NORMALIZED_C_COMP) = "gcc"
            {
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
              {
                flags +=
                  <cflags>"-Wsuggest-attribute=malloc"
                ;
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1400000 ]
                {
                  flags +=
                    <cflags>"-Wsuggest-attribute=returns_nonnull"
                  ;
                }
              }
              if ( $(x_suggest_attributes) = "all" || $(x_suggest_attributes) = "unity" )
              {
                if $(x_suggest_attributes) = "all"
                {
                  flags +=
                    <cflags>"-Wsuggest-attribute=pure"
                    <cflags>"-Wsuggest-attribute=const"
                  ;
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500001 ]
                  {
                    if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
                    {
                      flags +=
                        <cflags>"-Wsuggest-attribute=cold"
                      ;
                    }
                  }
                }
              }
            }
          }
          else
          {
            flags +=
              <cflags>"-Wno-missing-noreturn"
              <cflags>"-Wno-missing-format-attribute"
            ;
            if $(JLN_NORMALIZED_C_COMP) = "gcc"
            {
              flags +=
                <cflags>"-Wno-suggest-attribute=pure"
                <cflags>"-Wno-suggest-attribute=const"
              ;
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500000 ]
              {
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500001 ]
                {
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
                  {
                    flags +=
                      <cflags>"-Wno-suggest-attribute=malloc"
                    ;
                    if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1400000 ]
                    {
                      flags +=
                        <cflags>"-Wno-suggest-attribute=returns_nonnull"
                      ;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    if $(x_var_init) != "default"
    {
      if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1200000 ] ) || ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ] ) )
      {
        if $(x_var_init) = "pattern"
        {
          flags +=
            <cflags>"-ftrivial-auto-var-init=pattern"
          ;
          if $(JLN_NORMALIZED_C_COMP) = "gcc"
          {
            flags +=
              <cflags>"-Wtrivial-auto-var-init"
            ;
          }
        }
        else
        {
          if $(x_var_init) = "zero"
          {
            if ( ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less 1500000 $(JLN_NORMALIZED_C_COMP_VERSION) ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less 1500000 $(JLN_NORMALIZED_C_COMP_VERSION) ] ) )
            {
              if $(x_var_init) = "zero"
              {
                flags +=
                  <cflags>"-enable-trivial-auto-var-init-zero-knowing-it-will-be-removed-from-clang"
                ;
              }
            }
            else
            {
              flags +=
                <cflags>"-ftrivial-auto-var-init=zero"
              ;
              if $(JLN_NORMALIZED_C_COMP) = "gcc"
              {
                flags +=
                  <cflags>"-Wtrivial-auto-var-init"
                ;
              }
            }
          }
          else
          {
            flags +=
              <cflags>"-ftrivial-auto-var-init=uninitialized"
            ;
          }
        }
      }
    }
    if $(x_reproducible_build_warnings) != "default"
    {
      if ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400009 ] )
      {
        if $(x_reproducible_build_warnings) = "on"
        {
          flags +=
            <cflags>"-Wdate-time"
          ;
        }
        else
        {
          flags +=
            <cflags>"-Wno-date-time"
          ;
        }
      }
    }
    if $(x_warnings_as_error) != "default"
    {
      if $(x_warnings_as_error) = "on"
      {
        flags +=
          <cflags>"-Werror"
        ;
      }
      else
      {
        if $(x_warnings_as_error) = "basic"
        {
          flags +=
            <cflags>"-Werror=return-type"
            <cflags>"-Werror=init-self"
          ;
          if $(JLN_NORMALIZED_C_COMP) = "gcc"
          {
            flags +=
              <cflags>"-Werror=div-by-zero"
            ;
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500001 ]
            {
              flags +=
                <cflags>"-Werror=array-bounds"
                <cflags>"-Werror=logical-op"
                <cflags>"-Werror=logical-not-parentheses"
              ;
            }
          }
          else
          {
            flags +=
              <cflags>"-Werror=array-bounds"
              <cflags>"-Werror=division-by-zero"
            ;
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 300004 ]
            {
              flags +=
                <cflags>"-Werror=logical-not-parentheses"
              ;
            }
          }
        }
        else
        {
          flags +=
            <cflags>"-Wno-error"
          ;
        }
      }
    }
    if $(x_color) != "default"
    {
      if ( ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400009 ] || $(JLN_NORMALIZED_C_COMP) != "gcc" )
      {
        if $(x_color) = "auto"
        {
          flags +=
            <cflags>"-fdiagnostics-color=auto"
          ;
        }
        else
        {
          if $(x_color) = "never"
          {
            flags +=
              <cflags>"-fdiagnostics-color=never"
            ;
          }
          else
          {
            flags +=
              <cflags>"-fdiagnostics-color=always"
            ;
          }
        }
      }
    }
    if $(x_lto) != "default"
    {
      if $(x_lto) = "off"
      {
        flags +=
          <cflags>"-fno-lto"
          <linkflags>"-fno-lto"
        ;
        if $(JLN_NORMALIZED_C_COMP) = "gcc"
        {
          flags +=
            <cflags>"-fno-whole-program"
          ;
        }
      }
      else
      {
        if $(JLN_NORMALIZED_C_COMP) = "gcc"
        {
          if $(x_lto) != "thin-or-nothing"
          {
            if ( $(x_lto) = "whole-program" || $(x_lto) = "whole-program-and-full-lto" )
            {
              flags +=
                <cflags>"-fwhole-program"
              ;
            }
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1000000 ]
            {
              flags +=
                <cflags>"-flto=auto"
                <linkflags>"-flto=auto"
              ;
            }
            else
            {
              flags +=
                <cflags>"-flto"
                <linkflags>"-flto"
              ;
            }
          }
        }
        else
        {
          if ( ( $(x_lto) = "on" || $(x_lto) = "thin-or-nothing" || $(x_lto) = "whole-program" ) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400000 ] )
          {
            flags +=
              <cflags>"-flto=thin"
              <linkflags>"-flto=thin"
            ;
          }
          else
          {
            flags +=
              <cflags>"-flto"
              <linkflags>"-flto"
            ;
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1000000 ]
            {
              flags +=
                <cflags>"-fvirtual-function-elimination"
                <linkflags>"-fvirtual-function-elimination"
              ;
            }
          }
          if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 300009 ]
          {
            if ( $(x_lto) = "whole-program" || $(x_lto) = "whole-program-and-full-lto" )
            {
              flags +=
                <cflags>"-fwhole-program-vtables"
                <linkflags>"-fwhole-program-vtables"
              ;
            }
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700000 ]
            {
              flags +=
                <cflags>"-fforce-emit-vtables"
                <linkflags>"-fforce-emit-vtables"
              ;
            }
          }
        }
      }
    }
    if $(x_sanitizers) != "default"
    {
      if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400008 ] ) || ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 300002 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400000 ] ) )
      {
        if $(x_sanitizers) = "off"
        {
          flags +=
            <cflags>"-fno-sanitize=all"
            <linkflags>"-fno-sanitize=all"
          ;
        }
        else
        {
          if $(x_sanitizers) = "thread"
          {
            flags +=
              <cflags>"-fsanitize=thread"
              <linkflags>"-fsanitize=thread"
            ;
          }
          else
          {
            if $(x_sanitizers) = "undefined"
            {
              flags +=
                <cflags>"-fsanitize=undefined"
                <linkflags>"-fsanitize=undefined"
              ;
            }
            else
            {
              if $(x_sanitizers) = "undefined-minimal-runtime"
              {
                flags +=
                  <cflags>"-fsanitize=undefined"
                  <linkflags>"-fsanitize=undefined"
                ;
                if ( ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) || $(JLN_NORMALIZED_C_COMP) = "clang-cl" ) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 600000 ] )
                {
                  flags +=
                    <cflags>"-fsanitize-minimal-runtime"
                    <linkflags>"-fsanitize-minimal-runtime"
                  ;
                }
              }
              else
              {
                if $(x_sanitizers) = "scudo-hardened-allocator"
                {
                  if ( $(JLN_NORMALIZED_C_COMP) = "clang" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1300000 ] )
                  {
                    flags +=
                      <cflags>"-fsanitize=scudo"
                      <linkflags>"-fsanitize=scudo"
                    ;
                  }
                }
                else
                {
                  flags +=
                    <cflags>"-fno-omit-frame-pointer"
                    <cflags>"-fno-optimize-sibling-calls"
                    <cflags>"-fsanitize=address"
                    <linkflags>"-fsanitize=address"
                  ;
                  if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" )
                  {
                    if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400009 ] ) || $(JLN_NORMALIZED_C_IS_CLANG_LIKE) || $(JLN_NORMALIZED_C_COMP) = "clang-cl" )
                    {
                      flags +=
                        <cflags>"-fsanitize=undefined"
                        <linkflags>"-fsanitize=undefined"
                      ;
                    }
                    if ( $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra-with-minimal-code-size" )
                    {
                      if ( ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1300000 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1300000 ] ) )
                      {
                        flags +=
                          <cflags>"-fsanitize-address-use-after-return=always"
                          <linkflags>"-fsanitize-address-use-after-return=always"
                        ;
                      }
                    }
                    if ( $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" )
                    {
                      if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 900000 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 900000 ] ) )
                      {
                        flags +=
                          <cflags>"-fsanitize=pointer-compare"
                          <cflags>"-fsanitize=pointer-subtract"
                        ;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    if $(x_emcc_debug) != "default"
    {
      if $(JLN_NORMALIZED_C_COMP) = "clang-emcc"
      {
        if $(x_emcc_debug) = "off"
        {
          flags +=
            <linkflags>"-sASSERTIONS=0"
            <linkflags>"-sSAFE_HEAP=0"
            <linkflags>"-sSTACK_OVERFLOW_CHECK=0"
          ;
        }
        else
        {
          if $(x_emcc_debug) = "slow"
          {
            flags +=
              <linkflags>"-sASSERTIONS=2"
            ;
          }
          else
          {
            flags +=
              <linkflags>"-sASSERTIONS=1"
            ;
          }
          flags +=
            <linkflags>"-sSTACK_OVERFLOW_CHECK=2"
          ;
          if  ! ( ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" || $(x_sanitizers) = "address" || $(x_sanitizers) = "address-with-minimal-code-size" ) )
          {
            flags +=
              <linkflags>"-sSAFE_HEAP=1"
            ;
          }
        }
      }
    }
  }
  if $(x_conversion_warnings) != "default"
  {
    if ( $(JLN_NORMALIZED_C_COMP) = "gcc" || $(JLN_NORMALIZED_C_IS_CLANG_LIKE) || $(JLN_NORMALIZED_C_COMP) = "clang-cl" || $(JLN_NORMALIZED_C_COMP) = "intel' && $(original_version) = 'linux" )
    {
      if $(x_conversion_warnings) = "on"
      {
        flags +=
          <cflags>"-Wconversion"
          <cflags>"-Wsign-compare"
          <cflags>"-Wsign-conversion"
        ;
      }
      else
      {
        if $(x_conversion_warnings) = "conversion"
        {
          flags +=
            <cflags>"-Wconversion"
          ;
        }
        else
        {
          if $(x_conversion_warnings) = "float"
          {
            if $(JLN_NORMALIZED_C_COMP) = "gcc"
            {
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400009 ]
              {
                flags +=
                  <cflags>"-Wfloat-conversion"
                ;
              }
            }
            else
            {
              flags +=
                <cflags>"-Wfloat-conversion"
              ;
            }
          }
          else
          {
            if $(x_conversion_warnings) = "sign"
            {
              flags +=
                <cflags>"-Wsign-compare"
                <cflags>"-Wsign-conversion"
              ;
            }
            else
            {
              if $(x_conversion_warnings) = "all"
              {
                flags +=
                  <cflags>"-Wconversion"
                ;
                if $(JLN_NORMALIZED_C_COMP) = "gcc"
                {
                  flags +=
                    <cflags>"-Warith-conversion"
                  ;
                }
              }
              else
              {
                flags +=
                  <cflags>"-Wno-conversion"
                  <cflags>"-Wno-sign-compare"
                  <cflags>"-Wno-sign-conversion"
                ;
              }
            }
          }
        }
      }
    }
  }
  if ( $(JLN_NORMALIZED_C_COMP) = "gcc" || $(JLN_NORMALIZED_C_IS_CLANG_LIKE) )
  {
    if $(x_exceptions) != "default"
    {
      if $(x_exceptions) = "on"
      {
        flags +=
          <cflags>"-fexceptions"
        ;
        if $(JLN_NORMALIZED_C_COMP) = "clang-emcc"
        {
          flags +=
            <cflags>"-sDISABLE_EXCEPTION_CATCHING=0"
          ;
        }
      }
      else
      {
        flags +=
          <cflags>"-fno-exceptions"
        ;
      }
    }
    if $(x_hardened) != "default"
    {
      if ( $(x_hardened) = "on" || $(x_hardened) = "all" )
      {
        if ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1400000 ] )
        {
          flags +=
            <cflags>"-fhardened"
            <cflags>"-Whardened"
          ;
          if $(x_hardened) = "all"
          {
            flags +=
              <cflags>"-fstack-protector-all"
            ;
          }
          flags +=
            <cflags>"-Wtrampolines"
            <linkflags>"-Wl,-z,noexecstack"
          ;
        }
        else
        {
          if $(x_hardened) = "all"
          {
            flags +=
              <cflags>"-fstack-protector-all"
            ;
          }
          else
          {
            flags +=
              <cflags>"-fstack-protector-strong"
            ;
          }
          if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1200000 ] ) || ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1400000 ] ) )
          {
            flags +=
              <cflags>"-D_FORTIFY_SOURCE=3"
            ;
            if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1300000 ] ) || ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1600000 ] ) )
            {
              flags +=
                <cflags>"-fstrict-flex-arrays=3"
              ;
            }
          }
          else
          {
            flags +=
              <cflags>"-D_FORTIFY_SOURCE=2"
            ;
          }
          if $(x_var_init) = "default"
          {
            if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1200000 ] ) || ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ] ) )
            {
              if ( $(JLN_NORMALIZED_C_IS_CLANG_LIKE) && ! [ numbers.less 1500000 $(JLN_NORMALIZED_C_COMP_VERSION) ] )
              {
                flags +=
                  <cflags>"-enable-trivial-auto-var-init-zero-knowing-it-will-be-removed-from-clang"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-ftrivial-auto-var-init=zero"
                ;
                if $(JLN_NORMALIZED_C_COMP) = "gcc"
                {
                  flags +=
                    <cflags>"-Wtrivial-auto-var-init"
                  ;
                }
              }
            }
          }
          flags +=
            <cflags>"-fPIE"
            <linkflags>"-fPIE"
          ;
          if $(JLN_NORMALIZED_C_COMP) != "clang-emcc"
          {
            flags +=
              <cflags>"-pie"
              <linkflags>"-pie"
              <linkflags>"-Wl,-z,relro,-z,now"
              <linkflags>"-Wl,-z,noexecstack"
            ;
          }
          if $(JLN_NORMALIZED_C_COMP) = "gcc"
          {
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 400006 ]
            {
              flags +=
                <cflags>"-Wtrampolines"
              ;
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 800000 ]
              {
                flags +=
                  <cflags>"-fstack-clash-protection"
                  <cflags>"-fcf-protection=full"
                ;
              }
            }
          }
          else
          {
            if $(JLN_NORMALIZED_C_COMP) != "clang-emcc"
            {
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700000 ]
              {
                flags +=
                  <cflags>"-fcf-protection=full"
                ;
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1100000 ]
                {
                  flags +=
                    <cflags>"-fstack-clash-protection"
                  ;
                }
              }
            }
          }
        }
      }
    }
    if $(x_diagnostics_format) != "default"
    {
      if $(x_diagnostics_format) = "fixits"
      {
        if ( ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700000 ] ) || ( $(JLN_NORMALIZED_C_COMP) != "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 500000 ] ) )
        {
          flags +=
            <cflags>"-fdiagnostics-parseable-fixits"
          ;
        }
      }
      else
      {
        if $(x_diagnostics_format) = "patch"
        {
          if ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 700000 ] )
          {
            flags +=
              <cflags>"-fdiagnostics-generate-patch"
            ;
          }
        }
        else
        {
          if $(JLN_NORMALIZED_C_IS_CLANG_LIKE)
          {
            flags +=
              <cflags>"-fdiagnostics-print-source-range-info"
            ;
          }
        }
      }
    }
    if $(x_pedantic) != "default"
    {
      if $(x_pedantic) != "off"
      {
        flags +=
          <cflags>"-pedantic"
        ;
        if $(x_pedantic) = "as-error"
        {
          flags +=
            <cflags>"-pedantic-errors"
            <cflags>"-Werror=write-strings"
          ;
        }
      }
    }
    if $(x_symbols) != "default"
    {
      if $(x_symbols) = "hidden"
      {
        flags +=
          <cflags>"-fvisibility=hidden"
        ;
      }
      else
      {
        if $(x_symbols) = "strip-all"
        {
          flags +=
            <linkflags>"-s"
          ;
        }
        else
        {
          if $(x_symbols) = "gc-sections"
          {
            if $(linker) = 'ld64'
            {
              flags +=
                <linkflags>"-Wl,-S"
                <linkflags>"-Wl,-dead_strip"
              ;
            }
            flags +=
              <linkflags>"-s"
              <linkflags>"-Wl,--gc-sections"
            ;
          }
          else
          {
            if $(x_symbols) = "nodebug"
            {
              flags +=
                <cflags>"-g0"
              ;
            }
            else
            {
              if $(x_symbols) = "debug"
              {
                flags +=
                  <cflags>"-g"
                ;
              }
              else
              {
                if $(x_symbols) = "minimal-debug"
                {
                  flags +=
                    <cflags>"-g1"
                  ;
                }
                else
                {
                  if $(x_symbols) = "full-debug"
                  {
                    flags +=
                      <cflags>"-g3"
                    ;
                  }
                  else
                  {
                    if $(JLN_NORMALIZED_C_COMP) = "clang"
                    {
                      if $(x_symbols) = "dwarf"
                      {
                        flags +=
                          <cflags>"-g"
                        ;
                      }
                      if $(x_symbols) = "lldb"
                      {
                        flags +=
                          <cflags>"-glldb"
                        ;
                      }
                      if $(x_symbols) = "sce"
                      {
                        flags +=
                          <cflags>"-gsce"
                        ;
                      }
                      if $(x_symbols) = "dbx"
                      {
                        flags +=
                          <cflags>"-gdbx"
                        ;
                      }
                    }
                    else
                    {
                      if $(JLN_NORMALIZED_C_COMP) = "gcc"
                      {
                        if $(x_symbols) = "dwarf"
                        {
                          flags +=
                            <cflags>"-g"
                          ;
                        }
                        if $(x_symbols) = "codeview"
                        {
                          flags +=
                            <cflags>"-gcodeview"
                          ;
                        }
                        if $(x_symbols) = "btf"
                        {
                          flags +=
                            <cflags>"-gbtf"
                          ;
                        }
                        if $(x_symbols) = "ctf"
                        {
                          flags +=
                            <cflags>"-gctf"
                          ;
                        }
                        if $(x_symbols) = "ctf1"
                        {
                          flags +=
                            <cflags>"-gctf1"
                          ;
                        }
                        if $(x_symbols) = "ctf2"
                        {
                          flags +=
                            <cflags>"-gctf2"
                          ;
                        }
                        if $(x_symbols) = "vms"
                        {
                          flags +=
                            <cflags>"-gvms"
                          ;
                        }
                        if $(x_symbols) = "vms1"
                        {
                          flags +=
                            <cflags>"-gvms1"
                          ;
                        }
                        if $(x_symbols) = "vms2"
                        {
                          flags +=
                            <cflags>"-gvms2"
                          ;
                        }
                        if $(x_symbols) = "vms3"
                        {
                          flags +=
                            <cflags>"-gvms3"
                          ;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    if $(JLN_NORMALIZED_C_COMP) = "clang-emcc"
    {
      if $(x_optimization) != "default"
      {
        if $(x_optimization) = "0"
        {
          flags +=
            <cflags>"-O0"
            <linkflags>"-O0"
          ;
        }
        else
        {
          if $(x_optimization) = "g"
          {
            flags +=
              <cflags>"-Og"
              <linkflags>"-Og"
            ;
          }
          else
          {
            if $(x_optimization) = "1"
            {
              flags +=
                <cflags>"-O1"
                <linkflags>"-O1"
              ;
            }
            else
            {
              if $(x_optimization) = "2"
              {
                flags +=
                  <cflags>"-O2"
                  <linkflags>"-O2"
                ;
              }
              else
              {
                if $(x_optimization) = "3"
                {
                  flags +=
                    <cflags>"-O3"
                    <linkflags>"-O3"
                  ;
                }
                else
                {
                  if $(x_optimization) = "fast"
                  {
                    flags +=
                      <cflags>"-O3"
                      <cflags>"-mnontrapping-fptoint"
                      <linkflags>"-O3"
                      <linkflags>"-mnontrapping-fptoint"
                    ;
                  }
                  else
                  {
                    if $(x_optimization) = "size"
                    {
                      flags +=
                        <cflags>"-Os"
                        <linkflags>"-Os"
                      ;
                    }
                    else
                    {
                      flags +=
                        <cflags>"-Oz"
                        <linkflags>"-Oz"
                      ;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    else
    {
      if $(x_coverage) != "default"
      {
        if $(x_coverage) = "on"
        {
          flags +=
            <cflags>"--coverage"
            <linkflags>"--coverage"
          ;
          if $(JLN_NORMALIZED_C_COMP) = "clang"
          {
            flags +=
              <linkflags>"-lprofile_rt"
            ;
          }
        }
      }
      if $(x_optimization) != "default"
      {
        if $(x_optimization) = "0"
        {
          flags +=
            <cflags>"-O0"
          ;
        }
        else
        {
          if $(x_optimization) = "g"
          {
            flags +=
              <cflags>"-Og"
            ;
          }
          else
          {
            flags +=
              <linkflags>"-Wl,-O1"
            ;
            if $(x_optimization) = "1"
            {
              flags +=
                <cflags>"-O1"
              ;
            }
            else
            {
              if $(x_optimization) = "2"
              {
                flags +=
                  <cflags>"-O2"
                ;
              }
              else
              {
                if $(x_optimization) = "3"
                {
                  flags +=
                    <cflags>"-O3"
                  ;
                }
                else
                {
                  if $(x_optimization) = "size"
                  {
                    flags +=
                      <cflags>"-Os"
                    ;
                  }
                  else
                  {
                    if $(x_optimization) = "z"
                    {
                      if ( $(JLN_NORMALIZED_C_COMP) = "clang" || ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1200000 ] ) )
                      {
                        flags +=
                          <cflags>"-Oz"
                        ;
                      }
                      else
                      {
                        flags +=
                          <cflags>"-Os"
                        ;
                      }
                    }
                    else
                    {
                      if $(JLN_NORMALIZED_C_COMP) = "clang"
                      {
                        flags +=
                          <cflags>"-O3"
                          <cflags>"-ffast-math"
                        ;
                      }
                      else
                      {
                        flags +=
                          <cflags>"-Ofast"
                        ;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      if $(x_cpu) != "default"
      {
        if $(x_cpu) = "generic"
        {
          flags +=
            <cflags>"-mtune=generic"
            <linkflags>"-mtune=generic"
          ;
        }
        else
        {
          flags +=
            <cflags>"-march=native"
            <cflags>"-mtune=native"
            <linkflags>"-march=native"
            <linkflags>"-mtune=native"
          ;
        }
      }
      if $(x_linker) != "default"
      {
        if $(x_linker) = "mold"
        {
          flags +=
            <linkflags>"-fuse-ld=mold"
          ;
        }
        else
        {
          if $(x_linker) = "native"
          {
            if $(JLN_NORMALIZED_C_COMP) = "gcc"
            {
              flags +=
                <linkflags>"-fuse-ld=gold"
              ;
            }
            else
            {
              flags +=
                <linkflags>"-fuse-ld=lld"
              ;
            }
          }
          else
          {
            if $(x_linker) = "bfd"
            {
              flags +=
                <linkflags>"-fuse-ld=bfd"
              ;
            }
            else
            {
              if ( $(x_linker) = "gold" || ( $(JLN_NORMALIZED_C_COMP) = "gcc" && [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 900000 ] ) )
              {
                flags +=
                  <linkflags>"-fuse-ld=gold"
                ;
              }
              else
              {
                flags +=
                  <linkflags>"-fuse-ld=lld"
                ;
              }
            }
          }
        }
      }
      if $(x_analyzer) != "default"
      {
        if ( $(JLN_NORMALIZED_C_COMP) = "gcc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1000000 ] )
        {
          if $(x_analyzer) = "off"
          {
            flags +=
              <cflags>"-fno-analyzer"
            ;
          }
          else
          {
            flags +=
              <cflags>"-fanalyzer"
            ;
            if $(x_analyzer_too_complex_warning) != "default"
            {
              if $(x_analyzer_too_complex_warning) = "on"
              {
                flags +=
                  <cflags>"-Wanalyzer-too-complex"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-Wno-analyzer-too-complex"
                ;
              }
            }
            if $(x_analyzer_verbosity) != "default"
            {
              if $(x_analyzer_verbosity) = "0"
              {
                flags +=
                  <cflags>"-fanalyzer-verbosity=0"
                ;
              }
              else
              {
                if $(x_analyzer_verbosity) = "1"
                {
                  flags +=
                    <cflags>"-fanalyzer-verbosity=1"
                  ;
                }
                else
                {
                  if $(x_analyzer_verbosity) = "2"
                  {
                    flags +=
                      <cflags>"-fanalyzer-verbosity=2"
                    ;
                  }
                  else
                  {
                    flags +=
                      <cflags>"-fanalyzer-verbosity=3"
                    ;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  if ( $(JLN_NORMALIZED_C_COMP) = "msvc" || $(JLN_NORMALIZED_C_COMP) = "clang-cl" || $(JLN_NORMALIZED_C_COMP) = "intel' && $(original_version) = 'windows" )
  {
    if $(x_exceptions) != "default"
    {
      if $(x_exceptions) = "on"
      {
        flags +=
          <cflags>"/EHsc"
        ;
      }
      else
      {
        flags +=
          <cflags>"/EHs-c-"
        ;
      }
    }
    if $(x_rtti) != "default"
    {
      if $(x_rtti) = "on"
      {
        flags +=
          <cflags>"/GR"
        ;
      }
      else
      {
        flags +=
          <cflags>"/GR-"
        ;
      }
    }
    if $(x_stl_hardening) != "default"
    {
      if $(x_stl_hardening) = "off"
      {
        flags +=
          <cflags>"/D_SECURE_SCL=0"
        ;
      }
      else
      {
        if ( ! ( ( $(x_stl_hardening) = "fast" || $(x_stl_hardening) = "extensive" ) ) && $(x_stl_hardening) != "debug" )
        {
          flags +=
            <cflags>"/D_DEBUG"
          ;
        }
      }
    }
    if $(x_stl_fix) != "default"
    {
      if $(x_stl_fix) = "on"
      {
        flags +=
          <cflags>"/DNOMINMAX"
        ;
      }
    }
    if $(JLN_NORMALIZED_C_COMP) != "intel' && $(original_version) = 'windows"
    {
      if $(x_symbols) != "default"
      {
        if $(x_symbols) = "nodebug"
        {
          flags +=
            <linkflags>"/DEBUG:NONE"
          ;
        }
        else
        {
          if ( $(x_symbols) = "debug" || $(x_symbols) = "minimal-debug" || $(x_symbols) = "full-debug" || $(x_symbols) = "codeview" )
          {
            flags +=
              <cflags>"/Zi"
              <linkflags>"/DEBUG:FULL"
            ;
          }
          else
          {
            if $(JLN_NORMALIZED_C_COMP) = "clang-cl"
            {
              if $(x_symbols) = "dwarf"
              {
                flags +=
                  <linkflags>"-gdwarf"
                ;
              }
            }
          }
        }
      }
      if $(x_optimization) != "default"
      {
        if $(x_optimization) = "0"
        {
          flags +=
            <cflags>"/Od"
          ;
        }
        else
        {
          if $(x_optimization) = "g"
          {
            flags +=
              <cflags>"/Ob1"
            ;
          }
          else
          {
            if $(x_optimization) = "2"
            {
              flags +=
                <cflags>"/O2"
              ;
            }
            else
            {
              if ( $(x_optimization) = "1" || $(x_optimization) = "size" )
              {
                flags +=
                  <cflags>"/O1"
                ;
              }
              else
              {
                if $(x_optimization) = "z"
                {
                  flags +=
                    <cflags>"/O1"
                    <cflags>"/Gw"
                  ;
                }
                else
                {
                  if $(x_optimization) = "fast"
                  {
                    flags +=
                      <cflags>"/fp:fast"
                    ;
                  }
                  flags +=
                    <cflags>"/O2"
                  ;
                  if ( ( $(JLN_NORMALIZED_C_COMP) = "msvc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900020 ] ) || $(JLN_NORMALIZED_C_COMP) = "clang-cl" )
                  {
                    flags +=
                      <cflags>"/Ob3"
                    ;
                  }
                  flags +=
                    <cflags>"/Gw"
                  ;
                }
              }
            }
          }
        }
      }
      if $(x_hardened) != "default"
      {
        if $(x_hardened) = "off"
        {
          flags +=
            <cflags>"/GS-"
          ;
        }
        else
        {
          flags +=
            <cflags>"/sdl"
            <cflags>"/guard:cf"
          ;
          if ( ( $(JLN_NORMALIZED_C_COMP) = "msvc" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900027 ] ) || ( $(JLN_NORMALIZED_C_COMP) = "clang-cl" && ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1000000 ] ) )
          {
            flags +=
              <cflags>"/guard:ehcont"
              <linkflags>"/CETCOMPAT"
            ;
          }
        }
      }
    }
  }
  if $(JLN_NORMALIZED_C_COMP) = "msvc"
  {
    if $(x_analyzer) != "default"
    {
      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900000 ]
      {
        if $(x_analyzer) = "off"
        {
          flags +=
            <cflags>"/analyze-"
          ;
        }
        else
        {
          flags +=
            <cflags>"/analyze"
          ;
          if $(x_analyzer) != "with-external-headers"
          {
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1600010 ]
            {
              flags +=
                <cflags>"/analyze:external-"
              ;
            }
          }
        }
      }
    }
    if $(x_windows_bigobj) != "default"
    {
      flags +=
        <cflags>"/bigobj"
      ;
    }
    if $(x_msvc_crt_secure_no_warnings) != "default"
    {
      if $(x_msvc_crt_secure_no_warnings) = "on"
      {
        flags +=
          <cflags>"/D_CRT_SECURE_NO_WARNINGS=1"
        ;
      }
      else
      {
        if $(x_msvc_crt_secure_no_warnings) = "off"
        {
          flags +=
            <cflags>"/U_CRT_SECURE_NO_WARNINGS"
          ;
        }
      }
    }
    if $(x_msvc_diagnostics_format) != "default"
    {
      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900010 ]
      {
        if $(x_msvc_diagnostics_format) = "classic"
        {
          flags +=
            <cflags>"/diagnostics:classic"
          ;
        }
        else
        {
          if $(x_msvc_diagnostics_format) = "column"
          {
            flags +=
              <cflags>"/diagnostics:column"
            ;
          }
          else
          {
            flags +=
              <cflags>"/diagnostics:caret"
            ;
          }
        }
      }
    }
    if [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900013 ]
    {
      x_msvc_isystem = "default" ;
    }
    if $(x_msvc_isystem) != "default"
    {
      if $(x_msvc_isystem) = "external-as-include-system-flag"
      {
        if [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900029 ]
        {
          # unimplementable
        }
        else
        {
          # unimplementable
        }
      }
      else
      {
        if $(x_msvc_isystem) != "assumed"
        {
          if [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900029 ]
          {
            flags +=
              <cflags>"/experimental:external"
            ;
          }
          flags +=
            <cflags>"/external:W0"
          ;
          if $(x_msvc_isystem) = "anglebrackets"
          {
            flags +=
              <cflags>"/external:anglebrackets"
            ;
          }
          else
          {
            flags +=
              <cflags>"/external:env:INCLUDE"
              <cflags>"/external:env:CAExcludePath"
            ;
          }
        }
      }
      if $(x_msvc_isystem_with_template_instantiations_treated_as_non_external) != "default"
      {
        if $(x_msvc_isystem_with_template_instantiations_treated_as_non_external) = "off"
        {
          flags +=
            <cflags>"/external:templates"
          ;
        }
        else
        {
          flags +=
            <cflags>"/external:templates-"
          ;
        }
      }
    }
    if $(x_warnings) != "default"
    {
      if $(x_warnings) = "off"
      {
        flags +=
          <cflags>"/W0"
        ;
      }
      else
      {
        if $(x_warnings) = "essential"
        {
          flags +=
            <cflags>"/W4"
            <cflags>"/wd4711"
          ;
        }
        else
        {
          if $(x_warnings) = "on"
          {
            flags +=
              <cflags>"/W4"
              <cflags>"/wd4711"
              <cflags>"/w14296"
              <cflags>"/w14444"
              <cflags>"/w14555"
              <cflags>"/w14557"
              <cflags>"/w14905"
              <cflags>"/w14906"
              <cflags>"/w14917"
              <cflags>"/w14545"
              <cflags>"/w14546"
              <cflags>"/w14547"
              <cflags>"/w14548"
              <cflags>"/w14549"
            ;
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900000 ]
            {
              flags +=
                <cflags>"/w14426"
              ;
              if $(x_msvc_isystem) = "default"
              {
                flags +=
                  <cflags>"/w14654"
                ;
              }
              flags +=
                <cflags>"/w15031"
                <cflags>"/w15032"
              ;
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900011 ]
              {
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900015 ]
                {
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900022 ]
                  {
                    if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900025 ]
                    {
                      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900029 ]
                      {
                        flags +=
                          <cflags>"/w15240"
                        ;
                        if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900030 ]
                        {
                          flags +=
                            <cflags>"/w15249"
                          ;
                          if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900032 ]
                          {
                            flags +=
                              <cflags>"/w15258"
                            ;
                            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900034 ]
                            {
                              if $(x_msvc_isystem) = "default"
                              {
                                flags +=
                                  <cflags>"/w15262"
                                ;
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          else
          {
            flags +=
              <cflags>"/Wall"
              <cflags>"/wd4370"
              <cflags>"/wd4371"
              <cflags>"/wd4514"
              <cflags>"/wd4571"
              <cflags>"/wd4577"
              <cflags>"/wd4686"
              <cflags>"/wd4710"
              <cflags>"/wd4711"
              <cflags>"/wd4820"
              <cflags>"/wd4866"
            ;
            if $(x_msvc_isystem) = "default"
            {
              flags +=
                <cflags>"/wd4464"
                <cflags>"/wd4548"
                <cflags>"/wd4668"
              ;
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900000 ]
              {
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900034 ]
                {
                  flags +=
                    <cflags>"/wd5262"
                  ;
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900000 ]
                  {
                    flags +=
                      <cflags>"/wd4774"
                    ;
                  }
                }
              }
            }
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1600000 ]
            {
              flags +=
                <cflags>"/wd4800"
              ;
              if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900039 ]
              {
                flags +=
                  <cflags>"/wd4975"
                ;
                if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900040 ]
                {
                  flags +=
                    <cflags>"/wd4860"
                    <cflags>"/wd4861"
                    <cflags>"/wd5273"
                    <cflags>"/wd5274"
                  ;
                  if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900041 ]
                  {
                    flags +=
                      <cflags>"/wd5306"
                    ;
                    if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900043 ]
                    {
                      flags +=
                        <cflags>"/wd5277"
                      ;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    if $(x_conversion_warnings) != "default"
    {
      if ( $(x_conversion_warnings) = "off" || $(x_conversion_warnings) = "sign" )
      {
        flags +=
          <cflags>"/wd4244"
          <cflags>"/wd4245"
          <cflags>"/wd4365"
        ;
      }
      else
      {
        flags +=
          <cflags>"/w14244"
          <cflags>"/w14245"
          <cflags>"/w14365"
        ;
      }
      if ( $(x_conversion_warnings) = "on" || $(x_conversion_warnings) = "all" || $(x_conversion_warnings) = "sign" )
      {
        flags +=
          <cflags>"/w14018"
          <cflags>"/w14388"
          <cflags>"/w14289"
        ;
      }
      else
      {
        flags +=
          <cflags>"/wd4018"
          <cflags>"/wd4388"
          <cflags>"/wd4289"
        ;
      }
    }
    if $(x_switch_warnings) != "default"
    {
      if ( $(x_switch_warnings) = "on" || $(x_switch_warnings) = "mandatory-default" )
      {
        flags +=
          <cflags>"/wd4061"
          <cflags>"/w14062"
        ;
      }
      else
      {
        if ( $(x_switch_warnings) = "exhaustive-enum" || $(x_switch_warnings) = "exhaustive-enum-and-mandatory-default" )
        {
          flags +=
            <cflags>"/w14061"
            <cflags>"/w14062"
          ;
        }
        else
        {
          flags +=
            <cflags>"/wd4061"
            <cflags>"/wd4062"
          ;
        }
      }
    }
    if $(x_shadow_warnings) != "default"
    {
      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900000 ]
      {
        if $(x_shadow_warnings) = "off"
        {
          flags +=
            <cflags>"/wd4456"
            <cflags>"/wd4459"
          ;
        }
        else
        {
          if ( $(x_shadow_warnings) = "on" || $(x_shadow_warnings) = "all" )
          {
            flags +=
              <cflags>"/w14456"
              <cflags>"/w14459"
            ;
          }
          else
          {
            if $(x_shadow_warnings) = "local"
            {
              flags +=
                <cflags>"/w4456"
                <cflags>"/wd4459"
              ;
            }
          }
        }
      }
    }
    if $(x_warnings_as_error) != "default"
    {
      if $(x_warnings_as_error) = "on"
      {
        flags +=
          <cflags>"/WX"
        ;
      }
      else
      {
        if $(x_warnings_as_error) = "off"
        {
          flags +=
            <cflags>"/WX-"
          ;
        }
        else
        {
          flags +=
            <cflags>"/we4716"
            <cflags>"/we2124"
          ;
        }
      }
    }
    if $(x_pedantic) != "default"
    {
      if $(x_pedantic) != "off"
      {
        flags +=
          <cflags>"/permissive-"
          <cflags>"/Zc:inline"
        ;
        if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900013 ]
        {
          if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900014 ]
          {
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900025 ]
            {
              flags +=
                <cflags>"/Zc:preprocessor"
              ;
            }
          }
        }
        if $(x_pedantic) = "as-error"
        {
          flags +=
            <cflags>"/we4608"
          ;
          if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900031 ]
          {
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900038 ]
            {
              flags +=
                <cflags>"/we5110"
              ;
            }
          }
        }
        else
        {
          flags +=
            <cflags>"/w14608"
          ;
          if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900031 ]
          {
            if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900038 ]
            {
              flags +=
                <cflags>"/w15110"
              ;
            }
          }
        }
      }
    }
    if $(x_lto) != "default"
    {
      if $(x_lto) = "off"
      {
        flags +=
          <cflags>"/GL-"
        ;
      }
      else
      {
        if $(x_lto) != "thin-or-nothing"
        {
          flags +=
            <cflags>"/GL"
            <cflags>"/Gw"
            <linkflags>"/LTCG"
          ;
        }
      }
    }
    if $(x_sanitizers) != "default"
    {
      if ! [ numbers.less $(JLN_NORMALIZED_C_COMP_VERSION) 1900028 ]
      {
        if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" || $(x_sanitizers) = "address" || $(x_sanitizers) = "address-with-minimal-code-size" )
        {
          flags +=
            <cflags>"/fsanitize=address"
            <linkflags>"/fsanitize=address"
          ;
          if ( $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" )
          {
            flags +=
              <cflags>"/fsanitize-address-use-after-return"
            ;
          }
        }
      }
      else
      {
        if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" || $(x_sanitizers) = "address" || $(x_sanitizers) = "address-with-minimal-code-size" )
        {
          flags +=
            <cflags>"/sdl"
          ;
          if ( $(x_optimization) = "0" )
          {
            flags +=
              <cflags>"/RTCsu"
            ;
          }
        }
        else
        {
          if $(x_sanitizers) = "off"
          {
            if $(x_hardened) = "default"
            {
              flags +=
                <cflags>"/sdl-"
              ;
            }
          }
        }
      }
    }
  }
  else
  {
    if $(JLN_NORMALIZED_C_COMP) = "clang-cl"
    {
      if $(x_pedantic) != "default"
      {
        if $(x_pedantic) != "off"
        {
          if $(x_pedantic) = "as-error"
          {
            flags +=
              <cflags>"-Werror=write-strings"
            ;
          }
        }
      }
      if $(x_color) != "default"
      {
        if $(x_color) = "never"
        {
          flags +=
            <cflags>"-fno-color-diagnostics"
          ;
        }
        else
        {
          if $(x_color) = "always"
          {
            flags +=
              <cflags>"-fcolor-diagnostics"
            ;
          }
        }
      }
      if $(x_diagnostics_format) != "default"
      {
        if $(x_diagnostics_format) = "fixits"
        {
          flags +=
            <cflags>"-fdiagnostics-parseable-fixits"
          ;
        }
      }
      if $(x_cpu) != "default"
      {
        if $(x_cpu) = "generic"
        {
          flags +=
            <cflags>"-mtune=generic"
            <linkflags>"-mtune=generic"
          ;
        }
        else
        {
          flags +=
            <cflags>"-march=native"
            <cflags>"-mtune=native"
            <linkflags>"-march=native"
            <linkflags>"-mtune=native"
          ;
        }
      }
      if $(x_linker) != "default"
      {
        if ( $(x_linker) = "lld" || $(x_linker) = "native" )
        {
          flags +=
            <linkflags>"-fuse-ld=lld"
          ;
        }
        else
        {
          if $(x_linker) = "mold"
          {
            flags +=
              <linkflags>"-fuse-ld=mold"
            ;
          }
        }
      }
    }
    else
    {
      if $(JLN_NORMALIZED_C_COMP) = "intel' && $(original_version) = 'windows"
      {
        if $(x_warnings) != "default"
        {
          if $(x_warnings) = "off"
          {
            flags +=
              <cflags>"/w"
            ;
          }
          else
          {
            flags +=
              <cflags>"/W2"
              <cflags>"/Qdiag-disable:1418,2259"
            ;
          }
        }
        if $(x_warnings_as_error) != "default"
        {
          if $(x_warnings_as_error) = "on"
          {
            flags +=
              <cflags>"/WX"
            ;
          }
          else
          {
            if $(x_warnings_as_error) = "basic"
            {
              flags +=
                <cflags>"/Qdiag-error:1079,39,109"
              ;
            }
          }
        }
        if $(x_windows_bigobj) != "default"
        {
          flags +=
            <cflags>"/bigobj"
          ;
        }
        if $(x_symbols) != "default"
        {
          if $(x_symbols) = "nodebug"
          {
            flags +=
              <cflags>"/debug:none"
            ;
          }
          else
          {
            if $(x_symbols) = "minimal-debug"
            {
              flags +=
                <cflags>"/debug:minimal"
              ;
            }
            else
            {
              if ( $(x_symbols) = "debug" || $(x_symbols) = "full-debug" || $(x_symbols) = "codeview" )
              {
                flags +=
                  <cflags>"/debug:full"
                ;
              }
            }
          }
        }
        if $(x_optimization) != "default"
        {
          if $(x_optimization) = "0"
          {
            flags +=
              <cflags>"/Ob0"
            ;
          }
          else
          {
            if $(x_optimization) = "g"
            {
              flags +=
                <cflags>"/Ob1"
              ;
            }
            else
            {
              flags +=
                <cflags>"/GF"
              ;
              if $(x_optimization) = "1"
              {
                flags +=
                  <cflags>"/O1"
                ;
              }
              else
              {
                if $(x_optimization) = "2"
                {
                  flags +=
                    <cflags>"/O2"
                  ;
                }
                else
                {
                  if $(x_optimization) = "3"
                  {
                    flags +=
                      <cflags>"/O2"
                    ;
                  }
                  else
                  {
                    if $(x_optimization) = "z"
                    {
                      flags +=
                        <cflags>"/O3"
                      ;
                    }
                    else
                    {
                      if $(x_optimization) = "size"
                      {
                        flags +=
                          <cflags>"/Os"
                        ;
                      }
                      else
                      {
                        flags +=
                          <cflags>"/fast"
                        ;
                      }
                    }
                  }
                }
              }
            }
          }
        }
        if $(x_hardened) != "default"
        {
          if $(x_hardened) = "off"
          {
            flags +=
              <cflags>"/GS-"
            ;
          }
          else
          {
            flags +=
              <cflags>"/GS"
              <cflags>"/guard:cf"
              <cflags>"/mconditional-branch:all-fix"
              <cflags>"/Qcf-protection:full"
            ;
          }
        }
        if $(x_sanitizers) != "default"
        {
          if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" || $(x_sanitizers) = "address" || $(x_sanitizers) = "address-with-minimal-code-size" )
          {
            flags +=
              <cflags>"/Qtrapuv"
              <cflags>"/RTCsu"
            ;
            if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" )
            {
              flags +=
                <cflags>"/Qfp-stack-check"
                <cflags>"/Qfp-trap:common"
              ;
            }
          }
        }
        if $(x_cpu) != "default"
        {
          if $(x_cpu) = "generic"
          {
            flags +=
              <cflags>"/Qtune:generic"
              <linkflags>"/Qtune:generic"
            ;
          }
          else
          {
            flags +=
              <cflags>"/QxHost"
              <linkflags>"/QxHost"
            ;
          }
        }
      }
      else
      {
        if $(JLN_NORMALIZED_C_COMP) = "intel' && $(original_version) = 'linux"
        {
          if $(x_warnings) != "default"
          {
            if $(x_warnings) = "off"
            {
              flags +=
                <cflags>"-w"
              ;
            }
            else
            {
              if $(x_warnings) = "essential"
              {
                flags +=
                  <cflags>"-Wall"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-Wall"
                  <cflags>"-Warray-bounds"
                  <cflags>"-Wcast-qual"
                  <cflags>"-Wchar-subscripts"
                  <cflags>"-Wdisabled-optimization"
                  <cflags>"-Wenum-compare"
                  <cflags>"-Wextra"
                  <cflags>"-Wfloat-equal"
                  <cflags>"-Wformat-security"
                  <cflags>"-Wformat=2"
                  <cflags>"-Winit-self"
                  <cflags>"-Winvalid-pch"
                  <cflags>"-Wmaybe-uninitialized"
                  <cflags>"-Wmissing-include-dirs"
                  <cflags>"-Wnarrowing"
                  <cflags>"-Wnonnull"
                  <cflags>"-Wpointer-sign"
                  <cflags>"-Wreorder"
                  <cflags>"-Wsequence-point"
                  <cflags>"-Wtrigraphs"
                  <cflags>"-Wundef"
                  <cflags>"-Wunused-function"
                  <cflags>"-Wunused-but-set-variable"
                  <cflags>"-Wunused-variable"
                  <cflags>"-Wpointer-arith"
                  <cflags>"-Wold-style-definition"
                  <cflags>"-Wstrict-prototypes"
                  <cflags>"-Wwrite-strings"
                ;
              }
            }
          }
          if $(x_switch_warnings) != "default"
          {
            if ( $(x_switch_warnings) = "on" || $(x_switch_warnings) = "exhaustive-enum" )
            {
              flags +=
                <cflags>"-Wswitch-enum"
              ;
            }
            else
            {
              if $(x_switch_warnings) = "mandatory-default"
              {
                flags +=
                  <cflags>"-Wswitch-default"
                ;
              }
              else
              {
                if $(x_switch_warnings) = "exhaustive-enum-and-mandatory-default"
                {
                  flags +=
                    <cflags>"-Wswitch"
                  ;
                }
                else
                {
                  flags +=
                    <cflags>"-Wno-switch"
                  ;
                }
              }
            }
          }
          if $(x_warnings_as_error) != "default"
          {
            if $(x_warnings_as_error) = "on"
            {
              flags +=
                <cflags>"-Werror"
              ;
            }
            else
            {
              if $(x_warnings_as_error) = "basic"
              {
                flags +=
                  <cflags>"-diag-error=1079,39,109"
                ;
              }
            }
          }
          if $(x_pedantic) != "default"
          {
            if $(x_pedantic) = "off"
            {
              flags +=
                <cflags>"-fgnu-keywords"
              ;
            }
            else
            {
              flags +=
                <cflags>"-fno-gnu-keywords"
                <cflags>"/Zc:inline"
                <cflags>"/Zc:strictStrings"
                <cflags>"/Zc:throwingNew"
              ;
            }
          }
          if $(x_shadow_warnings) != "default"
          {
            if $(x_shadow_warnings) = "off"
            {
              flags +=
                <cflags>"-Wno-shadow"
              ;
            }
            else
            {
              if ( $(x_shadow_warnings) = "on" || $(x_shadow_warnings) = "all" )
              {
                flags +=
                  <cflags>"-Wshadow"
                ;
              }
            }
          }
          if $(x_symbols) != "default"
          {
            if $(x_symbols) = "nodebug"
            {
              flags +=
                <cflags>"-g0"
              ;
            }
            else
            {
              if $(x_symbols) = "hidden"
              {
                flags +=
                  <cflags>"-fvisibility=hidden"
                ;
              }
              else
              {
                if $(x_symbols) = "debug"
                {
                  flags +=
                    <cflags>"-g"
                  ;
                }
                else
                {
                  if $(x_symbols) = "minimal-debug"
                  {
                    flags +=
                      <cflags>"-g1"
                    ;
                  }
                  else
                  {
                    if $(x_symbols) = "full-debug"
                    {
                      flags +=
                        <cflags>"-g3"
                      ;
                    }
                  }
                }
              }
            }
          }
          if $(x_optimization) != "default"
          {
            if $(x_optimization) = "0"
            {
              flags +=
                <cflags>"-O0"
              ;
            }
            else
            {
              if $(x_optimization) = "g"
              {
                flags +=
                  <cflags>"-O1"
                ;
              }
              else
              {
                if $(x_optimization) = "1"
                {
                  flags +=
                    <cflags>"-O1"
                  ;
                }
                else
                {
                  if $(x_optimization) = "2"
                  {
                    flags +=
                      <cflags>"-O2"
                    ;
                  }
                  else
                  {
                    if $(x_optimization) = "3"
                    {
                      flags +=
                        <cflags>"-O3"
                      ;
                    }
                    else
                    {
                      if $(x_optimization) = "z"
                      {
                        flags +=
                          <cflags>"-fast"
                        ;
                      }
                      else
                      {
                        if $(x_optimization) = "size"
                        {
                          flags +=
                            <cflags>"-Os"
                          ;
                        }
                        else
                        {
                          flags +=
                            <cflags>"-Ofast"
                          ;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          if $(x_hardened) != "default"
          {
            if ( $(x_hardened) = "on" || $(x_hardened) = "all" )
            {
              flags +=
                <cflags>"-D_FORTIFY_SOURCE=2"
              ;
              if $(x_hardened) = "all"
              {
                flags +=
                  <cflags>"-fstack-protector-all"
                ;
              }
              else
              {
                flags +=
                  <cflags>"-fstack-protector-strong"
                ;
              }
              flags +=
                <cflags>"-fcf-protection=full"
                <linkflags>"-Xlinker-zrelro"
                <linkflags>"-Xlinker-znow"
                <linkflags>"-Xlinker-znoexecstack"
              ;
            }
          }
          if $(x_sanitizers) != "default"
          {
            if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" || $(x_sanitizers) = "address" || $(x_sanitizers) = "address-with-minimal-code-size" )
            {
              flags +=
                <cflags>"-ftrapuv"
              ;
              if ( $(x_sanitizers) = "on" || $(x_sanitizers) = "with-minimal-code-size" || $(x_sanitizers) = "extra" || $(x_sanitizers) = "extra-with-minimal-code-size" )
              {
                flags +=
                  <cflags>"-fp-stack-check"
                  <cflags>"-fp-trap=common"
                ;
              }
            }
          }
          if $(x_linker) != "default"
          {
            if $(x_linker) = "bfd"
            {
              flags +=
                <linkflags>"-fuse-ld=bfd"
              ;
            }
            else
            {
              if $(x_linker) = "gold"
              {
                flags +=
                  <linkflags>"-fuse-ld=gold"
                ;
              }
              else
              {
                if $(x_linker) = "mold"
                {
                  flags +=
                    <linkflags>"-fuse-ld=mold"
                  ;
                }
                else
                {
                  flags +=
                    <linkflags>"-fuse-ld=lld"
                  ;
                }
              }
            }
          }
          if $(x_lto) != "default"
          {
            if $(x_lto) = "off"
            {
              flags +=
                <cflags>"-no-ipo"
                <linkflags>"-no-ipo"
              ;
            }
            else
            {
              if $(x_lto) != "thin-or-nothing"
              {
                flags +=
                  <cflags>"-ipo"
                  <linkflags>"-ipo"
                ;
              }
            }
          }
          if $(x_exceptions) != "default"
          {
            if $(x_exceptions) = "on"
            {
              flags +=
                <cflags>"-fexceptions"
              ;
            }
            else
            {
              flags +=
                <cflags>"-fno-exceptions"
              ;
            }
          }
          if $(x_cpu) != "default"
          {
            if $(x_cpu) = "generic"
            {
              flags +=
                <cflags>"-mtune=generic"
                <linkflags>"-mtune=generic"
              ;
            }
            else
            {
              flags +=
                <cflags>"-xHost"
                <linkflags>"-xHost"
              ;
            }
          }
        }
        else
        {
          if [ os.name ] = MINGW
          {
            if $(x_windows_bigobj) != "default"
            {
              flags +=
                <cflags>"-Wa,-mbig-obj"
              ;
            }
          }
        }
      }
    }
  }
  return $(flags) ;
}
